{"version":3,"sources":["components/CriteriosDeterioro/CriteriosDeterioro.js"],"names":["CriteriosDeterioro","props","state","idCriterioDeterioro","nombreCriterioDeterioroSeleccionado","mostrarComponente","tiposDeCredito","estimacionesDeterioro","criterioDeterioroSel","goCreateCriteria","bind","goSelectCriteria","goEditCriteria","loadTypeCredit","createCreditTypeSonsArray","insertCriterioDet","transaction","sql","Transaction","pool","begin","err","rolledBack","on","aborted","request","Request","query","result","console","log","rollback","commit","setState","recordset","arregloTemp","i","length","ID","creditoID","index","array","undefined","$","merge","id","nombre","objeto","localeCompare","showConfigurationComponent","React","Component"],"mappings":"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","sourcesContent":["import React from 'react';\nimport sql from 'mssql';\n\nimport SeleccionarCriterioDeterioro from './SeleccionarCriterioDeterioro.js';\nimport CrearCriterioDeterioro from './CrearCriterioDeterioro.js';\nimport EditarCriterioDeterioro from './EditarCriterioDeterioro.js';\n\nexport default class CriteriosDeterioro extends React.Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            idCriterioDeterioro: -1,\n            nombreCriterioDeterioroSeleccionado: \"\",\n            mostrarComponente: \"selCrit\",\n            tiposDeCredito: [],\n            estimacionesDeterioro: [],\n            criterioDeterioroSel: {}\n        }\n        this.goCreateCriteria = this.goCreateCriteria.bind(this);\n        this.goSelectCriteria = this.goSelectCriteria.bind(this);\n        this.goEditCriteria = this.goEditCriteria.bind(this);\n        this.loadTypeCredit = this.loadTypeCredit.bind(this);\n        this.createCreditTypeSonsArray = this.createCreditTypeSonsArray.bind(this);\n        this.insertCriterioDet = this.insertCriterioDet.bind(this);\n    }\n\n    componentDidMount() {\n        this.loadTypeCredit();\n    }\n\n    loadTypeCredit() {\n        const transaction = new sql.Transaction( this.props.pool );\n        transaction.begin(err => {\n            var rolledBack = false;\n            transaction.on('rollback', aborted => {\n                rolledBack = true;\n            });\n            const request = new sql.Request(transaction);\n            request.query(\"select * from TipoCredito where tipoCreditoPadreID != -1\", (err, result) => {\n                if (err) {\n                    if (!rolledBack) {\n                        console.log(err);\n                        transaction.rollback(err => {\n                        });\n                    }\n                } else {\n                    transaction.commit(err => {\n                        this.setState({\n                            tiposDeCredito: result.recordset\n                        });\n                        this.createCreditTypeSonsArray();\n                    });\n                }\n            });\n        }); // fin transaction\n    }\n\n    createCreditTypeSonsArray() {\n        var arregloTemp = [];\n        for (var i = 0; i < this.state.tiposDeCredito.length; i++) {\n            this.insertCriterioDet(this.state.tiposDeCredito[i].ID, i, arregloTemp);\n        };\n    }\n\n    insertCriterioDet(creditoID, index, array) {\n        const transaction = new sql.Transaction( this.props.pool );\n        transaction.begin(err => {\n            var rolledBack = false;\n            transaction.on('rollback', aborted => {\n                rolledBack = true;\n            });\n            const request = new sql.Request(transaction);\n            request.query(\"select * from CriterioDeterioro where tipoDeCredito = \"+creditoID, (err, result) => {\n                if (err) {\n                    if (!rolledBack) {\n                        console.log(err);\n                        transaction.rollback(err => {\n                        });\n                    }\n                } else {\n                    transaction.commit(err => {\n                        if(array[index] == undefined) {\n                            array[index] = [];\n                        }\n                        array[index] = $.merge(array[index], result.recordset);\n                        this.setState({\n                            estimacionesDeterioro: array\n                        });\n                    });\n                }\n            });\n        }); // fin transaction\n    }\n\n    goCreateCriteria () {\n        this.setState({\n            mostrarComponente: \"crearCrit\"\n        });\n    }\n\n    goSelectCriteria () {\n        this.loadTypeCredit();\n        this.setState({\n            idCriterioDeterioro: -1,\n            nombreCriterioDeterioroSeleccionado: \"\",\n            mostrarComponente: \"selCrit\",\n            criterioDeterioroSel: {}\n        });\n    }\n\n    goEditCriteria (id, nombre, objeto) {\n        this.setState({\n            idCriterioDeterioro: id,\n            nombreCriterioDeterioroSeleccionado: nombre,\n            mostrarComponente: \"editCrit\",\n            criterioDeterioroSel: objeto\n        });\n    }\n\n    render() {\n        if(this.state.mostrarComponente.localeCompare(\"crearCrit\") == 0) {\n            return (\n                <div>\n                    <CrearCriterioDeterioro pool={this.props.pool} showConfigurationComponent={this.props.showConfigurationComponent} returnSelCrit={this.goSelectCriteria} tiposDeCredito={this.state.tiposDeCredito}> </CrearCriterioDeterioro>\n                </div>\n            );\n        } else if(this.state.mostrarComponente.localeCompare(\"selCrit\") == 0) {\n            return (\n                <div>\n                    <SeleccionarCriterioDeterioro pool={this.props.pool} showConfigurationComponent={this.props.showConfigurationComponent} seleccionarCriterio={this.goEditCriteria} goCrearCredito={this.goCreateCriteria} tiposDeCredito={this.state.tiposDeCredito} estimacionesDeterioro={this.state.estimacionesDeterioro}> </SeleccionarCriterioDeterioro>\n                </div>\n            );\n        } else if(this.state.mostrarComponente.localeCompare(\"editCrit\") == 0) {\n            return (\n                <div>\n                    <EditarCriterioDeterioro criterioDeterioro={this.state.criterioDeterioroSel} pool={this.props.pool} showConfigurationComponent={this.props.showConfigurationComponent} returnSelCrit={this.goSelectCriteria} tiposDeCredito={this.state.tiposDeCredito}> </EditarCriterioDeterioro>\n                </div>\n            );\n        }\n    }\n}\n"],"file":"CriteriosDeterioro.js"}