{"version":3,"sources":["components/Variables/FuenteDatos/CamposHome.js"],"names":["isMounted","FuenteDatosHome","props","state","componenteActual","idFuenteDatos","nombreFuenteDatos","descripcionFuenteDatos","formulaFuenteDatos","esObjetoFuenteDatos","objetoPadreIDFuenteDatos","nivelFuenteDatos","crearFuenteDatos","bind","retornoSeleccionFuenteDatosSameComponent","retornoSeleccionFuenteDatosDiffComponent","editarFuenteDatos","retornoEditarFuenteDatos","terminoCrearFuenteDatosPasarAEdit","setState","showRiesgos","self","setTimeout","idRiesgoSeleccionado","id","nombreRiesgo","pesoRiesgo","toleranciaRiesgo","valorIdealRiesgo","padreRiesgo","console","log","transaction","sql","Transaction","pool","begin","err","rolledBack","on","aborted","request","Request","query","result","rollback","commit","recordset","undefined","length","ID","nombre","peso","tolerancia","valorIdeal","idRiesgoPadre","localeCompare","configuracionHome","showCondicionVar","nombreTablaSeleccionada","showFormula","retornoSeleccionRiesgoSameComponent","retornoSeleccionRiesgoDiffComponent","updateNavBar","showUmbralHome","updateFormula","React","Component"],"mappings":"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","sourcesContent":["import React from 'react';\nimport sql from 'mssql';\n\nimport SeleccionarFuenteDatos from './SeleccionarFuenteDatos.js';\nimport CrearFuenteDatos from './CrearFuenteDatos.js';\nimport EditarFuenteDatos from './EditarFuenteDatos.js';\n\nvar isMounted = false;\n\nexport default class FuenteDatosHome extends React.Component {\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            componenteActual: \"selFuenteDatos\",\n            idFuenteDatos: -1,\n            nombreFuenteDatos: \"\",\n            descripcionFuenteDatos: \"\",\n            formulaFuenteDatos: \"\",\n            esObjetoFuenteDatos: \"\",\n            objetoPadreIDFuenteDatos: -1,\n            nivelFuenteDatos: -1\n        }\n        this.crearFuenteDatos = this.crearFuenteDatos.bind(this);\n        this.retornoSeleccionFuenteDatosSameComponent = this.retornoSeleccionFuenteDatosSameComponent.bind(this);\n        this.retornoSeleccionFuenteDatosDiffComponent = this.retornoSeleccionFuenteDatosDiffComponent.bind(this);\n        this.editarFuenteDatos = this.editarFuenteDatos.bind(this);\n        this.retornoEditarFuenteDatos = this.retornoEditarFuenteDatos.bind(this);\n        this.terminoCrearFuenteDatosPasarAEdit = this.terminoCrearFuenteDatosPasarAEdit.bind(this);\n    }\n\n    componentDidMount() {\n        isMounted = true;\n    }\n    componentWillUnmount() {\n        isMounted = false;\n    }\n\n    crearFuenteDatos () {\n        this.setState({\n            componenteActual: \"crearFuenteDatos\"\n        });\n    }\n\n    retornoSeleccionFuenteDatosSameComponent () {\n        this.setState({\n            componenteActual: \"selFuenteDatos\",\n            idFuenteDatos: -1,\n            nombreFuenteDatos: \"\",\n            descripcionFuenteDatos: \"\",\n            formulaFuenteDatos: \"\",\n            esObjetoFuenteDatos: \"\",\n            objetoPadreIDFuenteDatos: -1,\n            nivelFuenteDatos: -1\n        });\n    }\n\n    retornoSeleccionFuenteDatosDiffComponent () {\n        this.props.showRiesgos();\n        var self = this;\n        setTimeout(function(){\n            self.setState({\n                idRiesgoSeleccionado: -1,\n                componenteActual: \"selFuenteDatos\"\n            });\n        }, 500);\n    }\n\n    editarFuenteDatos (idFuenteDatos, nombreFuenteDatos, descripcionFuenteDatos, formulaFuenteDatos, esObjetoFuenteDatos, objetoPadreIDFuenteDatos, nivelFuenteDatos) {\n        this.setState({\n            idRiesgoSeleccionado: id,\n            componenteActual: \"editarFuenteDatos\",\n            nombreRiesgo: nombreRiesgo,\n            pesoRiesgo: pesoRiesgo,\n            toleranciaRiesgo: toleranciaRiesgo,\n            valorIdealRiesgo: valorIdealRiesgo,\n            padreRiesgo: padreRiesgo\n        });\n    }\n\n    retornoEditarFuenteDatos () {\n        this.props.showRiesgos();\n        var self = this;\n        if(isMounted) {\n            console.log(\"SI\")\n        } else {\n            console.log(\"NO\")\n        }\n        setTimeout(function(){\n            if(isMounted) {\n                console.log(\"SI\")\n            } else {\n                console.log(\"NO\")\n            }\n            console.log(self)\n            self.setState({\n                componenteActual: \"editarFuenteDatos\"\n            });\n        }, 3500);\n    }\n\n    terminoCrearFuenteDatosPasarAEdit (nombreFuenteDatos) {\n        const transaction = new sql.Transaction( this.props.pool );\n        transaction.begin(err => {\n            var rolledBack = false;\n            transaction.on('rollback', aborted => {\n                rolledBack = true;\n            });\n            const request = new sql.Request(transaction);\n            request.query(\"select * from Variables where nombre = '\"+nombreFuenteDatos+\"'\", (err, result) => {\n                if (err) {\n                    if (!rolledBack) {\n                        console.log(err);\n                        transaction.rollback(err => {\n                        });\n                    }\n                } else {\n                    transaction.commit(err => {\n                        if(result.recordset != undefined) {\n                            if(result.recordset.length) {\n                                this.editarFuenteDatos(result.recordset[0].ID, result.recordset[0].nombre, result.recordset[0].peso, result.recordset[0].tolerancia, result.recordset[0].valorIdeal, result.recordset[0].idRiesgoPadre);\n                            }\n                        }\n                    });\n                }\n            });\n        }); // fin transaction\n    }\n\n    render() {\n        if(this.state.componenteActual.localeCompare(\"selFuenteDatos\") == 0) {\n            return (\n                <div>\n                    <SeleccionarFuenteDatos configuracionHome={this.props.configuracionHome} crearFuenteDatos={this.crearFuenteDatos} editarFuenteDatos={this.editarFuenteDatos}> </SeleccionarFuenteDatos>\n                </div>\n            );\n        } else if(this.state.componenteActual.localeCompare(\"crearFuenteDatos\") == 0) {\n            return (\n                <div>\n                    <CrearFuenteDatos pool={this.props.pool} showCondicionVar={this.props.showCondicionVar} terminoCrearRiesgo={this.terminoCrearFuenteDatosPasarAEdit} nombreTablaSeleccionada={this.props.nombreTablaSeleccionada}> </CrearFuenteDatos>\n                </div>\n            );\n        } else if(this.state.componenteActual.localeCompare(\"editarFuenteDatos\") == 0) {\n            return (\n                <div>\n                    <EditarFuenteDatos pool={this.props.pool} showFormula={this.props.showFormula} showCondicionVar={this.props.showCondicionVar} showRiesgos={this.props.showRiesgos} retornoSeleccionRiesgo={this.retornoSeleccionRiesgoSameComponent} retornoSeleccionRiesgoUmbral={this.retornoSeleccionRiesgoDiffComponent} configuracionHome={this.props.configuracionHome} updateNavBar={this.props.updateNavBar} showUmbralHome={this.props.showUmbralHome} riesgos={[]} nombreRiesgo={this.state.nombreRiesgo} pesoRiesgo={this.state.pesoRiesgo} toleranciaRiesgo={this.state.toleranciaRiesgo} valorIdealRiesgo={this.state.valorIdealRiesgo} padreRiesgo={this.state.padreRiesgo} updateFormula={this.props.updateFormula}> </EditarFuenteDatos>\n                </div>\n            );\n        }\n    }\n}\n"],"file":"CamposHome.js"}