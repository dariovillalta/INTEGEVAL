{"version":3,"sources":["components/Variables/FuenteDatos/CamposHome.js"],"names":["isMounted","FuenteDatosHome","props","state","componenteActual","idFuenteDatos","nombreFuenteDatos","descripcionFuenteDatos","esObjetoFuenteDatos","objetoPadreIDFuenteDatos","guardarFuenteDatos","columnas","crearFuenteDatos","bind","retornoSeleccionFuenteDatos","editarFuenteDatos","retornoEditarFuenteDatos","terminoCrearFuenteDatosPasarAEdit","transaction","sql","Transaction","pool","begin","err","rolledBack","on","aborted","request","Request","query","nombreTablaSeleccionada","result","console","log","rollback","commit","nombreColumnas","i","recordset","length","push","valor","COLUMN_NAME","tipo","DATA_TYPE","setState","showRiesgos","self","setTimeout","undefined","ID","nombre","descripcion","esObjeto","objetoPadreID","guardar","localeCompare","configuracionHome","goOptions","retornoSeleccionTabla","showCondicionVar","idTablaSeleccionada","showFormula","retornoSeleccionRiesgoSameComponent","retornoSeleccionRiesgoDiffComponent","updateNavBar","showUmbralHome","updateFormula","React","Component"],"mappings":"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","sourcesContent":["import React from 'react';\nimport sql from 'mssql';\n\nimport SeleccionarFuenteDatos from './SeleccionarFuenteDatos.js';\nimport CrearFuenteDatosHome from './CrearFuenteDatos/CrearFuenteDatosHome.js';\nimport EditarFuenteDatos from './EditarFuenteDatos.js';\n\nvar isMounted = false;\n\nexport default class FuenteDatosHome extends React.Component {\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            componenteActual: \"selFuenteDatos\",\n            idFuenteDatos: -1,\n            nombreFuenteDatos: \"\",\n            descripcionFuenteDatos: \"\",\n            esObjetoFuenteDatos: \"\",\n            objetoPadreIDFuenteDatos: -1,\n            guardarFuenteDatos: \"\",\n            columnas: []\n        }\n        this.crearFuenteDatos = this.crearFuenteDatos.bind(this);\n        this.retornoSeleccionFuenteDatos = this.retornoSeleccionFuenteDatos.bind(this);\n        this.editarFuenteDatos = this.editarFuenteDatos.bind(this);\n        this.retornoEditarFuenteDatos = this.retornoEditarFuenteDatos.bind(this);\n        this.terminoCrearFuenteDatosPasarAEdit = this.terminoCrearFuenteDatosPasarAEdit.bind(this);\n    }\n\n    componentDidMount () {\n        const transaction = new sql.Transaction( this.props.pool );\n        transaction.begin(err => {\n            var rolledBack = false;\n            transaction.on('rollback', aborted => {\n                rolledBack = true;\n            });\n            const request = new sql.Request(transaction);\n            request.query(\"select * from INFORMATION_SCHEMA.COLUMNS where TABLE_NAME = '\"+this.props.nombreTablaSeleccionada+\"'\", (err, result) => {\n                if (err) {\n                    if (!rolledBack) {\n                        console.log(err);\n                        transaction.rollback(err => {\n                        });\n                    }\n                } else {\n                    transaction.commit(err => {\n                        var nombreColumnas = [];\n                        for (var i = 0; i < result.recordset.length; i++) {\n                            nombreColumnas.push({valor: result.recordset[i].COLUMN_NAME, tipo: result.recordset[i].DATA_TYPE});\n                        };\n                        this.setState({\n                            columnas: nombreColumnas\n                        });\n                    });\n                }\n            });\n        }); // fin transaction\n    }\n\n    crearFuenteDatos () {\n        this.setState({\n            componenteActual: \"crearFuenteDatos\"\n        });\n    }\n\n    retornoSeleccionFuenteDatos () {\n        this.setState({\n            componenteActual: \"selFuenteDatos\",\n            idFuenteDatos: -1,\n            nombreFuenteDatos: \"\",\n            descripcionFuenteDatos: \"\",\n            esObjetoFuenteDatos: \"\",\n            objetoPadreIDFuenteDatos: -1,\n            guardarFuenteDatos: \"\"\n        });\n    }\n\n    editarFuenteDatos (idFuenteDatos, nombreFuenteDatos, descripcionFuenteDatos, esObjetoFuenteDatos, objetoPadreIDFuenteDatos, guardarFuenteDatos) {\n        this.setState({\n            idFuenteDatos: idFuenteDatos,\n            componenteActual: \"editarFuenteDatos\",\n            nombreFuenteDatos: nombreFuenteDatos,\n            descripcionFuenteDatos: descripcionFuenteDatos,\n            esObjetoFuenteDatos: esObjetoFuenteDatos,\n            objetoPadreIDFuenteDatos: objetoPadreIDFuenteDatos,\n            guardarFuenteDatos: guardarFuenteDatos\n        });\n    }\n\n    retornoEditarFuenteDatos () {\n        this.props.showRiesgos();\n        var self = this;\n        if(isMounted) {\n            console.log(\"SI\")\n        } else {\n            console.log(\"NO\")\n        }\n        setTimeout(function(){\n            if(isMounted) {\n                console.log(\"SI\")\n            } else {\n                console.log(\"NO\")\n            }\n            console.log(self)\n            self.setState({\n                componenteActual: \"editarFuenteDatos\"\n            });\n        }, 3500);\n    }\n\n    terminoCrearFuenteDatosPasarAEdit (nombreFuenteDatos) {\n        const transaction = new sql.Transaction( this.props.pool );\n        transaction.begin(err => {\n            var rolledBack = false;\n            transaction.on('rollback', aborted => {\n                rolledBack = true;\n            });\n            const request = new sql.Request(transaction);\n            request.query(\"select * from Campos where nombre = '\"+nombreFuenteDatos+\"'\", (err, result) => {\n                if (err) {\n                    if (!rolledBack) {\n                        console.log(err);\n                        transaction.rollback(err => {\n                        });\n                    }\n                } else {\n                    transaction.commit(err => {\n                        if(result.recordset != undefined) {\n                            if(result.recordset.length) {\n                                this.editarFuenteDatos(result.recordset[0].ID, result.recordset[0].nombre, result.recordset[0].descripcion, result.recordset[0].esObjeto, result.recordset[0].objetoPadreID, result.recordset[0].guardar);\n                            }\n                        }\n                    });\n                }\n            });\n        }); // fin transaction\n    }\n\n    render() {\n        if(this.state.componenteActual.localeCompare(\"selFuenteDatos\") == 0) {\n            return (\n                <div>\n                    <SeleccionarFuenteDatos pool={this.props.pool}\n                                            configuracionHome={this.props.configuracionHome}\n                                            crearFuenteDatos={this.crearFuenteDatos}\n                                            goOptions={this.props.goOptions}\n                                            retornoSeleccionTabla={this.props.retornoSeleccionTabla}\n                                            editarFuenteDatos={this.editarFuenteDatos}>\n                    </SeleccionarFuenteDatos>\n                </div>\n            );\n        } else if(this.state.componenteActual.localeCompare(\"crearFuenteDatos\") == 0) {\n            return (\n                <div>\n                    <CrearFuenteDatosHome pool={this.props.pool}\n                                            showCondicionVar={this.props.showCondicionVar}\n                                            terminoCrearCampo={this.terminoCrearFuenteDatosPasarAEdit}\n                                            idTablaSeleccionada={this.props.idTablaSeleccionada}\n                                            columnas={this.state.columnas}\n                                            nombreTablaSeleccionada={this.props.nombreTablaSeleccionada}\n                                            goOptions={this.props.goOptions}\n                                            retornoSeleccionTabla={this.props.retornoSeleccionTabla}\n                                            retornoSeleccionFuenteDatos={this.retornoSeleccionFuenteDatos}\n                                            configuracionHome={this.props.configuracionHome}>\n                    </CrearFuenteDatosHome>\n                </div>\n            );\n        } else if(this.state.componenteActual.localeCompare(\"editarFuenteDatos\") == 0) {\n            return (\n                <div>\n                    <EditarFuenteDatos pool={this.props.pool}\n                                    showFormula={this.props.showFormula}\n                                    showCondicionVar={this.props.showCondicionVar}\n                                    showRiesgos={this.props.showRiesgos}\n                                    goOptions={this.props.goOptions}\n                                    retornoSeleccionTabla={this.props.retornoSeleccionTabla}\n                                    retornoSeleccionFuenteDatos={this.retornoSeleccionFuenteDatos}\n                                    retornoSeleccionRiesgo={this.retornoSeleccionRiesgoSameComponent}\n                                    retornoSeleccionRiesgoUmbral={this.retornoSeleccionRiesgoDiffComponent}\n                                    configuracionHome={this.props.configuracionHome}\n                                    updateNavBar={this.props.updateNavBar}\n                                    showUmbralHome={this.props.showUmbralHome}\n                                    idFuenteDatos={this.state.idFuenteDatos}\n                                    nombreFuenteDatos={this.state.nombreFuenteDatos}\n                                    descripcionFuenteDatos={this.state.descripcionFuenteDatos}\n                                    esObjetoFuenteDatos={this.state.esObjetoFuenteDatos}\n                                    objetoPadreIDFuenteDatos={this.state.objetoPadreIDFuenteDatos}\n                                    guardarFuenteDatos={this.state.guardarFuenteDatos}\n                                    updateFormula={this.props.updateFormula}>\n                    </EditarFuenteDatos>\n                </div>\n            );\n        }\n    }\n}\n"],"file":"CamposHome.js"}