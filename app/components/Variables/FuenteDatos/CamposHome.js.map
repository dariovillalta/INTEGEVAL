{"version":3,"sources":["components/Variables/FuenteDatos/CamposHome.js"],"names":["isMounted","FuenteDatosHome","props","state","componenteActual","idFuenteDatos","nombreFuenteDatos","tipoFuenteDatos","guardarFuenteDatos","formulaFuenteDatos","crearFuenteDatos","bind","retornoSeleccionFuenteDatosSameComponent","retornoSeleccionFuenteDatosDiffComponent","editarFuenteDatos","retornoEditarFuenteDatos","terminoCrearFuenteDatosPasarAEdit","setState","showRiesgos","self","setTimeout","console","log","transaction","sql","Transaction","pool","begin","err","rolledBack","on","aborted","request","Request","query","result","rollback","commit","recordset","undefined","length","ID","nombre","peso","tolerancia","valorIdeal","idRiesgoPadre","localeCompare","configuracionHome","showCondicionVar","idTablaSeleccionada","nombreTablaSeleccionada","showFormula","retornoSeleccionRiesgoSameComponent","retornoSeleccionRiesgoDiffComponent","updateNavBar","showUmbralHome","updateFormula","React","Component"],"mappings":"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","sourcesContent":["import React from 'react';\nimport sql from 'mssql';\n\nimport SeleccionarFuenteDatos from './SeleccionarFuenteDatos.js';\nimport CrearFuenteDatos from './CrearFuenteDatos.js';\nimport EditarFuenteDatos from './EditarFuenteDatos.js';\n\nvar isMounted = false;\n\nexport default class FuenteDatosHome extends React.Component {\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            componenteActual: \"selFuenteDatos\",\n            idFuenteDatos: -1,\n            nombreFuenteDatos: \"\",\n            tipoFuenteDatos: \"\",\n            guardarFuenteDatos: \"\",\n            formulaFuenteDatos: \"\"\n        }\n        this.crearFuenteDatos = this.crearFuenteDatos.bind(this);\n        this.retornoSeleccionFuenteDatosSameComponent = this.retornoSeleccionFuenteDatosSameComponent.bind(this);\n        this.retornoSeleccionFuenteDatosDiffComponent = this.retornoSeleccionFuenteDatosDiffComponent.bind(this);\n        this.editarFuenteDatos = this.editarFuenteDatos.bind(this);\n        this.retornoEditarFuenteDatos = this.retornoEditarFuenteDatos.bind(this);\n        this.terminoCrearFuenteDatosPasarAEdit = this.terminoCrearFuenteDatosPasarAEdit.bind(this);\n    }\n\n    componentDidMount() {\n        isMounted = true;\n    }\n    componentWillUnmount() {\n        isMounted = false;\n    }\n\n    crearFuenteDatos () {\n        this.setState({\n            componenteActual: \"crearFuenteDatos\"\n        });\n    }\n\n    retornoSeleccionFuenteDatosSameComponent () {\n        this.setState({\n            componenteActual: \"selFuenteDatos\",\n            idFuenteDatos: -1,\n            nombreFuenteDatos: \"\",\n            tipoFuenteDatos: \"\",\n            guardarFuenteDatos: \"\",\n            formulaFuenteDatos: \"\"\n        });\n    }\n\n    retornoSeleccionFuenteDatosDiffComponent () {\n        this.props.showRiesgos();\n        var self = this;\n        setTimeout(function(){\n            self.setState({\n                idFuenteDatos: -1,\n                componenteActual: \"selFuenteDatos\"\n            });\n        }, 500);\n    }\n\n    editarFuenteDatos (idFuenteDatos, nombreFuenteDatos, tipoFuenteDatos, guardarFuenteDatos, formulaFuenteDatos) {\n        this.setState({\n            idFuenteDatos: idFuenteDatos,\n            componenteActual: \"editarFuenteDatos\",\n            nombreFuenteDatos: nombreFuenteDatos,\n            tipoFuenteDatos: tipoFuenteDatos,\n            guardarFuenteDatos: guardarFuenteDatos,\n            formulaFuenteDatos: formulaFuenteDatos\n        });\n    }\n\n    retornoEditarFuenteDatos () {\n        this.props.showRiesgos();\n        var self = this;\n        if(isMounted) {\n            console.log(\"SI\")\n        } else {\n            console.log(\"NO\")\n        }\n        setTimeout(function(){\n            if(isMounted) {\n                console.log(\"SI\")\n            } else {\n                console.log(\"NO\")\n            }\n            console.log(self)\n            self.setState({\n                componenteActual: \"editarFuenteDatos\"\n            });\n        }, 3500);\n    }\n\n    terminoCrearFuenteDatosPasarAEdit (nombreFuenteDatos) {\n        const transaction = new sql.Transaction( this.props.pool );\n        transaction.begin(err => {\n            var rolledBack = false;\n            transaction.on('rollback', aborted => {\n                rolledBack = true;\n            });\n            const request = new sql.Request(transaction);\n            request.query(\"select * from Campos where nombre = '\"+nombreFuenteDatos+\"'\", (err, result) => {\n                if (err) {\n                    if (!rolledBack) {\n                        console.log(err);\n                        transaction.rollback(err => {\n                        });\n                    }\n                } else {\n                    transaction.commit(err => {\n                        if(result.recordset != undefined) {\n                            if(result.recordset.length) {\n                                this.editarFuenteDatos(result.recordset[0].ID, result.recordset[0].nombre, result.recordset[0].peso, result.recordset[0].tolerancia, result.recordset[0].valorIdeal, result.recordset[0].idRiesgoPadre);\n                            }\n                        }\n                    });\n                }\n            });\n        }); // fin transaction\n    }\n\n    render() {\n        if(this.state.componenteActual.localeCompare(\"selFuenteDatos\") == 0) {\n            return (\n                <div>\n                    <SeleccionarFuenteDatos pool={this.props.pool} configuracionHome={this.props.configuracionHome} crearFuenteDatos={this.crearFuenteDatos} editarFuenteDatos={this.editarFuenteDatos}> </SeleccionarFuenteDatos>\n                </div>\n            );\n        } else if(this.state.componenteActual.localeCompare(\"crearFuenteDatos\") == 0) {\n            return (\n                <div>\n                    <CrearFuenteDatos pool={this.props.pool} showCondicionVar={this.props.showCondicionVar} terminoCrearCampo={this.terminoCrearFuenteDatosPasarAEdit} idTablaSeleccionada={this.props.idTablaSeleccionada} nombreTablaSeleccionada={this.props.nombreTablaSeleccionada} configuracionHome={this.props.configuracionHome}> </CrearFuenteDatos>\n                </div>\n            );\n        } else if(this.state.componenteActual.localeCompare(\"editarFuenteDatos\") == 0) {\n            return (\n                <div>\n                    <EditarFuenteDatos pool={this.props.pool} showFormula={this.props.showFormula} showCondicionVar={this.props.showCondicionVar} showRiesgos={this.props.showRiesgos} retornoSeleccionRiesgo={this.retornoSeleccionRiesgoSameComponent} retornoSeleccionRiesgoUmbral={this.retornoSeleccionRiesgoDiffComponent} configuracionHome={this.props.configuracionHome} updateNavBar={this.props.updateNavBar} showUmbralHome={this.props.showUmbralHome} idFuenteDatos={this.state.idFuenteDatos} nombreFuenteDatos={this.state.nombreFuenteDatos} tipoFuenteDatos={this.state.tipoFuenteDatos} guardarFuenteDatos={this.state.guardarFuenteDatos} formulaFuenteDatos={this.state.formulaFuenteDatos} updateFormula={this.props.updateFormula}> </EditarFuenteDatos>\n                </div>\n            );\n        }\n    }\n}\n"],"file":"CamposHome.js"}