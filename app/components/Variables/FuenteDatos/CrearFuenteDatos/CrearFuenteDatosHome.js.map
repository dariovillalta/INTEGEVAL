{"version":3,"sources":["components/Variables/FuenteDatos/CrearFuenteDatos/CrearFuenteDatosHome.js"],"names":["campo","CrearFuenteDatosHome","props","state","componenteActual","atributos","reglas","texto","nivel","esCondicion","formulas","indiceSeleccionado","tipoIndiceSeleccionado","posicionNuevoAtributo","navbar","loadRules","bind","sortRules","returnToCreateDataSource","goToCreateConditions","createDataSource","getDataSourceID","retornarCampo","actualizarIndiceSeleccionado","actualizarIndiceSeleccionadoIrCondicionesNuevoAtributo","actualizarCondicion","anadirAtributo","anadirRegla","tempCopy","i","length","setState","configuracionHome","goOptions","retornoSeleccionTabla","retornoSeleccionFuenteDatos","fuenteDato","atributoFuenteDato","transaction","sql","Transaction","pool","begin","err","rolledBack","on","aborted","request","Request","query","idTablaSeleccionada","nombre","descripcion","esObjeto","objetoPadreID","guardar","result","console","log","rollback","commit","tipo","formula","terminoCrearCampo","campoNuevo","indice","tipoIndice","showCondicionVar","nombreAtributo","$","val","undefined","tempCopyRules","push","tempCopyFormulas","nuevoAtributo","operacion","valor","posicionAInsertar","copiaAntiguaReglas","nuevaRegla","reglaPadreID","localeCompare","variablePadre","ID","actualizarNivelReglas","posicionInsertarNuevo","alert","width","height","columnas","nombreTablaSeleccionada","React","Component"],"mappings":";;;;;;;AAAA;;AAEA;;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAEA,IAAIA,KAAJ;AAEA;;AACA;;AACA;;;;AAIA;;AACA;;AACA;;;;AAIA;;AACA;;AACA;;;;IAIqBC,oB;;;;;AACjB,gCAAYC,KAAZ,EAAmB;AAAA;;AAAA;;AACf,8FAAMA,KAAN;AACA,UAAKC,KAAL,GAAa;AACTC,MAAAA,gBAAgB,EAAE,aADT;AAETC,MAAAA,SAAS,EAAE,EAFF;AAGTC,MAAAA,MAAM,EAAE,CAAE,CAAC;AAACC,QAAAA,KAAK,EAAE,SAAR;AAAmBC,QAAAA,KAAK,EAAE,CAA1B;AAA6BC,QAAAA,WAAW,EAAE;AAA1C,OAAD,EAAmD;AAACF,QAAAA,KAAK,EAAE,SAAR;AAAmBC,QAAAA,KAAK,EAAE,CAA1B;AAA6BC,QAAAA,WAAW,EAAE;AAA1C,OAAnD,EAAoG;AAACF,QAAAA,KAAK,EAAE,SAAR;AAAmBC,QAAAA,KAAK,EAAE,CAA1B;AAA6BC,QAAAA,WAAW,EAAE;AAA1C,OAApG,EAAsJ;AAACF,QAAAA,KAAK,EAAE,SAAR;AAAmBC,QAAAA,KAAK,EAAE,CAA1B;AAA6BC,QAAAA,WAAW,EAAE;AAA1C,OAAtJ,EAAwM;AAACF,QAAAA,KAAK,EAAE,SAAR;AAAmBC,QAAAA,KAAK,EAAE,CAA1B;AAA6BC,QAAAA,WAAW,EAAE;AAA1C,OAAxM,CAAF,CAHC;AAITC,MAAAA,QAAQ,EAAE,EAJD;AAKTC,MAAAA,kBAAkB,EAAE,CAAC,CALZ;AAMTC,MAAAA,sBAAsB,EAAE,EANf;AAMqC;AAC9CC,MAAAA,qBAAqB,EAAE,CAPd;AAOqC;AAC9CJ,MAAAA,WAAW,EAAE,IARJ;AAQsC;AAC/CK,MAAAA,MAAM,EAAE;AATC,KAAb;AAWA,UAAKC,SAAL,GAAiB,MAAKA,SAAL,CAAeC,IAAf,+BAAjB;AACA,UAAKC,SAAL,GAAiB,MAAKA,SAAL,CAAeD,IAAf,+BAAjB;AACA,UAAKE,wBAAL,GAAgC,MAAKA,wBAAL,CAA8BF,IAA9B,+BAAhC;AACA,UAAKG,oBAAL,GAA4B,MAAKA,oBAAL,CAA0BH,IAA1B,+BAA5B;AACA,UAAKI,gBAAL,GAAwB,MAAKA,gBAAL,CAAsBJ,IAAtB,+BAAxB;AACA,UAAKK,eAAL,GAAuB,MAAKA,eAAL,CAAqBL,IAArB,+BAAvB;AACA,UAAKM,aAAL,GAAqB,MAAKA,aAAL,CAAmBN,IAAnB,+BAArB;AACA,UAAKO,4BAAL,GAAoC,MAAKA,4BAAL,CAAkCP,IAAlC,+BAApC;AACA,UAAKQ,sDAAL,GAA8D,MAAKA,sDAAL,CAA4DR,IAA5D,+BAA9D;AACA,UAAKS,mBAAL,GAA2B,MAAKA,mBAAL,+BAA3B;AACA,UAAKC,cAAL,GAAsB,MAAKA,cAAL,CAAoBV,IAApB,+BAAtB;AACA,UAAKW,WAAL,GAAmB,MAAKA,WAAL,CAAiBX,IAAjB,+BAAnB;AAxBe;AAyBlB;;;;wCAEoB,CACpB;;;gCAEW;AACR;AACA,WAAKC,SAAL;AACH;;;gCAEW;AACR,UAAIW,QAAQ,sBAAO,KAAKzB,KAAL,CAAWG,MAAlB,CAAZ;;AACA,WAAK,IAAIuB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGD,QAAQ,CAACE,MAA7B,EAAqCD,CAAC,EAAtC,EAA0C;AACtCD,QAAAA,QAAQ,CAACC,CAAD,CAAR;AACH;;AAAA;AACJ;;;+CAE2B;AACxB,WAAKE,QAAL,CAAc;AACV3B,QAAAA,gBAAgB,EAAE;AADR,OAAd;AAGH;;;2CAEuB;AACpB,UAAIU,MAAM,GAAG;AAAK,QAAA,SAAS,EAAE;AAAhB,SACT;AAAK,QAAA,SAAS,EAAE;AAAhB,SACI;AAAK,QAAA,SAAS,EAAE;AAAhB,SACI;AAAI,QAAA,SAAS,EAAE;AAAf,uBADJ,EAEI;AAAK,QAAA,SAAS,EAAE;AAAhB,SACI;AAAK,sBAAW;AAAhB,SACI;AAAI,QAAA,SAAS,EAAE;AAAf,SACI;AAAI,QAAA,SAAS,EAAE,yBAAf;AAA0C,wBAAa,MAAvD;AAA8D,QAAA,OAAO,EAAE,KAAKZ,KAAL,CAAW8B;AAAlF,SAAqG;AAAG,QAAA,IAAI,EAAC,GAAR;AAAY,QAAA,SAAS,EAAE;AAAvB,4BAArG,CADJ,EAEI;AAAI,QAAA,SAAS,EAAE,yBAAf;AAA0C,wBAAa,MAAvD;AAA8D,QAAA,OAAO,EAAE,KAAK9B,KAAL,CAAW+B;AAAlF,SAA6F;AAAG,QAAA,IAAI,EAAC,GAAR;AAAY,QAAA,SAAS,EAAE;AAAvB,4BAA7F,CAFJ,EAGI;AAAI,QAAA,SAAS,EAAE,yBAAf;AAA0C,wBAAa,MAAvD;AAA8D,QAAA,OAAO,EAAE,KAAK/B,KAAL,CAAWgC;AAAlF,SAAyG;AAAG,QAAA,IAAI,EAAC,GAAR;AAAY,QAAA,SAAS,EAAE;AAAvB,kBAAzG,CAHJ,EAII;AAAI,QAAA,SAAS,EAAE,yBAAf;AAA0C,wBAAa,MAAvD;AAA8D,QAAA,OAAO,EAAE,KAAKhC,KAAL,CAAWiC;AAAlF,SAA+G;AAAG,QAAA,IAAI,EAAC,GAAR;AAAY,QAAA,SAAS,EAAE;AAAvB,4BAA/G,CAJJ,EAKI;AAAI,QAAA,SAAS,EAAE,yBAAf;AAA0C,wBAAa,MAAvD;AAA8D,QAAA,OAAO,EAAE,KAAKjB;AAA5E,SAAsG;AAAG,QAAA,IAAI,EAAC,GAAR;AAAY,QAAA,SAAS,EAAE;AAAvB,iCAAtG,CALJ,EAMI;AAAI,QAAA,SAAS,EAAE,gCAAf;AAAiD,wBAAa;AAA9D,uBANJ,CADJ,CADJ,CAFJ,CADJ,CADS,CAAb;;AAmBA,WAAKa,QAAL,CAAc;AACV3B,QAAAA,gBAAgB,EAAE,mBADR;AAEVU,QAAAA,MAAM,EAAEA;AAFE,OAAd;AAIH;;;qCAEiBsB,U,EAAYC,kB,EAAoB;AAAA;;AAC9C;AACA,UAAMC,WAAW,GAAG,IAAIC,GAAG,CAACC,WAAR,CAAqB,KAAKtC,KAAL,CAAWuC,IAAhC,CAApB;AACAH,MAAAA,WAAW,CAACI,KAAZ,CAAkB,UAAAC,GAAG,EAAI;AACrB,YAAIC,UAAU,GAAG,KAAjB;AACAN,QAAAA,WAAW,CAACO,EAAZ,CAAe,UAAf,EAA2B,UAAAC,OAAO,EAAI;AAClCF,UAAAA,UAAU,GAAG,IAAb;AACH,SAFD;AAGA,YAAMG,OAAO,GAAG,IAAIR,GAAG,CAACS,OAAR,CAAgBV,WAAhB,CAAhB;AACAS,QAAAA,OAAO,CAACE,KAAR,CAAc,8FAA4F,MAAI,CAAC/C,KAAL,CAAWgD,mBAAvG,GAA2H,KAA3H,GAAiId,UAAU,CAACe,MAA5I,GAAmJ,MAAnJ,GAA0Jf,UAAU,CAACgB,WAArK,GAAiL,MAAjL,GAAwLhB,UAAU,CAACiB,QAAnM,GAA4M,KAA5M,GAAkNjB,UAAU,CAACkB,aAA7N,GAA2O,KAA3O,GAAiPlB,UAAU,CAACmB,OAA5P,GAAoQ,OAAlR,EAA2R,UAACZ,GAAD,EAAMa,MAAN,EAAiB;AACxS,cAAIb,GAAJ,EAAS;AACL,gBAAI,CAACC,UAAL,EAAiB;AACba,cAAAA,OAAO,CAACC,GAAR,CAAYf,GAAZ;AACAL,cAAAA,WAAW,CAACqB,QAAZ,CAAqB,UAAAhB,GAAG,EAAI,CAC3B,CADD;AAEH;AACJ,WAND,MAMO;AACHL,YAAAA,WAAW,CAACsB,MAAZ,CAAmB,UAAAjB,GAAG,EAAI;AACtB,cAAA,MAAI,CAACzC,KAAL,CAAWmB,eAAX,CAA2BgB,kBAA3B;AACH,aAFD;AAGH;AACJ,SAZD;AAaH,OAnBD,EAH8C,CAsB1C;AACP;;;oCAEgBD,U,EAAYC,kB,EAAoB;AAAA;;AAC7C;AACA,UAAMC,WAAW,GAAG,IAAIC,GAAG,CAACC,WAAR,CAAqB,KAAKtC,KAAL,CAAWuC,IAAhC,CAApB;AACAH,MAAAA,WAAW,CAACI,KAAZ,CAAkB,UAAAC,GAAG,EAAI;AACrB,YAAIC,UAAU,GAAG,KAAjB;AACAN,QAAAA,WAAW,CAACO,EAAZ,CAAe,UAAf,EAA2B,UAAAC,OAAO,EAAI;AAClCF,UAAAA,UAAU,GAAG,IAAb;AACH,SAFD;AAGA,YAAMG,OAAO,GAAG,IAAIR,GAAG,CAACS,OAAR,CAAgBV,WAAhB,CAAhB;AACAS,QAAAA,OAAO,CAACE,KAAR,CAAc,iFAA+E,MAAI,CAAC/C,KAAL,CAAWgD,mBAA1F,GAA8G,KAA9G,GAAoHC,MAApH,GAA2H,MAA3H,GAAkIU,IAAlI,GAAuI,MAAvI,GAA8IN,OAA9I,GAAsJ,MAAtJ,GAA6JO,OAA7J,GAAqK,KAArK,GAA2KtD,KAA3K,GAAiL,GAA/L,EAAoM,UAACmC,GAAD,EAAMa,MAAN,EAAiB;AACjN,cAAIb,GAAJ,EAAS;AACL,gBAAI,CAACC,UAAL,EAAiB;AACba,cAAAA,OAAO,CAACC,GAAR,CAAYf,GAAZ;AACAL,cAAAA,WAAW,CAACqB,QAAZ,CAAqB,UAAAhB,GAAG,EAAI,CAC3B,CADD;AAEH;AACJ,WAND,MAMO;AACHL,YAAAA,WAAW,CAACsB,MAAZ,CAAmB,UAAAjB,GAAG,EAAI;AACtB,cAAA,MAAI,CAACzC,KAAL,CAAW6D,iBAAX,CAA6BZ,MAA7B;AACH,aAFD;AAGH;AACJ,SAZD;AAaH,OAnBD,EAH6C,CAsBzC;AACP;;;kCAEca,U,EAAY;AACvBhE,MAAAA,KAAK,GAAGgE,UAAR;AACH;;;iDAE6BC,M,EAAQC,U,EAAY;AAC9C,WAAKnC,QAAL,CAAc;AACVpB,QAAAA,kBAAkB,EAAEsD,MADV;AAEVrD,QAAAA,sBAAsB,EAAEsD;AAFd,OAAd;AAIH;;;6EAEyD;AACtD,WAAKnC,QAAL,CAAc;AACVpB,QAAAA,kBAAkB,EAAE,CAAC,CADX;AAEVC,QAAAA,sBAAsB,EAAE;AAFd,OAAd,EAGG,KAAKV,KAAL,CAAWiE,gBAHd;AAIH;;;wCAEoB1D,W,EAAa;AAC9B,WAAKsB,QAAL,CAAc;AACVtB,QAAAA,WAAW,EAAEA;AADH,OAAd;AAGH;;;qCAEiB;AACd,UAAI2D,cAAc,GAAGC,CAAC,CAAC,iBAAD,CAAD,CAAqBC,GAArB,EAArB,CADc,CAEd;;AACA,UAAG,KAAKnE,KAAL,CAAWG,MAAX,CAAkB,KAAKH,KAAL,CAAWU,qBAA7B,KAAuD0D,SAA1D,EAAqE;AACjE,YAAIC,aAAa,sBAAO,KAAKrE,KAAL,CAAWG,MAAlB,CAAjB;;AACAkE,QAAAA,aAAa,CAACC,IAAd,CAAmB,EAAnB;AACA,aAAK1C,QAAL,CAAc;AACVzB,UAAAA,MAAM,EAAEkE;AADE,SAAd;AAGH,OATa,CAUd;;;AACA,UAAG,KAAKrE,KAAL,CAAW2D,OAAX,CAAmB,KAAK3D,KAAL,CAAWU,qBAA9B,KAAwD0D,SAA3D,EAAsE;AAClE,YAAIG,gBAAgB,sBAAO,KAAKvE,KAAL,CAAW2D,OAAlB,CAApB;;AACAY,QAAAA,gBAAgB,CAACD,IAAjB,CAAsB,EAAtB;AACA,aAAK1C,QAAL,CAAc;AACV+B,UAAAA,OAAO,EAAEY;AADC,SAAd;AAGH;;AACD,UAAIC,aAAJ,CAlBc,CAmBd;;AACA,UAAG,KAAKxE,KAAL,CAAWE,SAAX,CAAqB,KAAKF,KAAL,CAAWU,qBAAhC,KAA0D0D,SAA7D,EAAwE;AACpEI,QAAAA,aAAa,GAAG;AAACxB,UAAAA,MAAM,EAAEiB,cAAT;AAAyBP,UAAAA,IAAI,EAAE;AAA/B,SAAhB;AACH,OAFD,MAEO;AACHc,QAAAA,aAAa,GAAG,KAAKxE,KAAL,CAAWE,SAAX,CAAqB,KAAKF,KAAL,CAAWU,qBAAhC,CAAhB;AACA8D,QAAAA,aAAa,CAACxB,MAAd,GAAuBiB,cAAvB;AACH;;AACD,UAAIxC,QAAQ,sBAAO,KAAKzB,KAAL,CAAWE,SAAlB,CAAZ;;AACAuB,MAAAA,QAAQ,CAAC6C,IAAT,CAAcE,aAAd;AACA,WAAK5C,QAAL,CAAc;AACV1B,QAAAA,SAAS,EAAEuB;AADD,OAAd;AAGH;;;kCAEc;AACX;AACA;AACA;AACA;AACA,UAAG,KAAKzB,KAAL,CAAWM,WAAd,EAA2B,CACvB;AACH,OAFD,MAEO,CACH;AACH;;AACD,UAAI,KAAKN,KAAL,CAAWQ,kBAAX,IAAiC,CAAC,CAAlC,IAAwC,KAAKR,KAAL,CAAWQ,kBAAX,IAAiC,CAAC,CAAlC,IAAuC,KAAKR,KAAL,CAAWG,MAAX,CAAkBwB,MAAlB,IAA4B,CAA/G,EAAoH;AAChH,YAAI8C,SAAS,GAAGP,CAAC,CAAC,sCAAD,CAAD,CAA0CC,GAA1C,EAAhB;AACA,YAAIO,KAAK,GAAGR,CAAC,CAAC,QAAD,CAAD,CAAYC,GAAZ,EAAZ;AACAb,QAAAA,OAAO,CAACC,GAAR,CAAY,WAAZ;AACAD,QAAAA,OAAO,CAACC,GAAR,CAAYkB,SAAZ;AACAnB,QAAAA,OAAO,CAACC,GAAR,CAAY,OAAZ;AACAD,QAAAA,OAAO,CAACC,GAAR,CAAYmB,KAAZ;AACApB,QAAAA,OAAO,CAACC,GAAR,CAAY,OAAZ;AACAD,QAAAA,OAAO,CAACC,GAAR,CAAY1D,KAAZ;AACA,YAAI8E,iBAAiB,GAAG,CAAC,CAAzB;;AACA,YAAG,KAAK3E,KAAL,CAAWQ,kBAAX,IAAiC,CAAC,CAArC,EAAwC;AACpCmE,UAAAA,iBAAiB,GAAG,KAAK3E,KAAL,CAAWQ,kBAA/B;AACH;;AACD,YAAIoE,kBAAkB,sBAAO,KAAK5E,KAAL,CAAWG,MAAlB,CAAtB;;AACA,YAAI0E,UAAU,GAAG;AAAChF,UAAAA,KAAK,EAAEA,KAAK,CAAC6E,KAAd;AAAqBD,UAAAA,SAAS,EAAEA,SAAhC;AAA2CC,UAAAA,KAAK,EAAEA,KAAlD;AAAyDtE,UAAAA,KAAK,EAAE,OAAhE;AAAyE0E,UAAAA,YAAY,EAAE,CAAC,CAAxF;AAA2FzE,UAAAA,KAAK,EAAE;AAAlG,SAAjB;;AACA,YAAGsE,iBAAiB,IAAI,CAAC,CAAzB,EAA4B;AACxBC,UAAAA,kBAAkB,CAACN,IAAnB,CAAwBO,UAAxB;AACH,SAFD,MAEO;AACH,cAAG,KAAK7E,KAAL,CAAWS,sBAAX,CAAkCsE,aAAlC,CAAgD,aAAhD,KAAkE,CAArE,EAAwE;AACpE,gBAAIC,aAAa,GAAG,KAAKhF,KAAL,CAAWG,MAAX,CAAkBwE,iBAAlB,CAApB;AACAE,YAAAA,UAAU,CAACC,YAAX,GAA0BE,aAAa,CAACC,EAAxC;AACAJ,YAAAA,UAAU,CAACxE,KAAX,GAAmB2E,aAAa,CAAC3E,KAAd,GAAsB,CAAzC;AACA,gBAAIoB,QAAJ;AACA,iBAAKyD,qBAAL,CAA2BL,UAA3B,EAAuCM,qBAAvC;AACH;;AAAC,cAAG,KAAKnF,KAAL,CAAWS,sBAAX,CAAkCsE,aAAlC,CAAgD,QAAhD,KAA6D,CAAhE,EAAmE,CACpE;AACJ;AACJ,OA3BD,MA2BO;AACHK,QAAAA,KAAK,CAAC,4DAAD,CAAL;AACH;AACJ;;;6BAEQ;AACL,UAAG,KAAKpF,KAAL,CAAWC,gBAAX,CAA4B8E,aAA5B,CAA0C,aAA1C,KAA4D,CAA/D,EAAkE;AAC9D,eACI;AAAK,UAAA,KAAK,EAAE;AAACM,YAAAA,KAAK,EAAE,MAAR;AAAgBC,YAAAA,MAAM,EAAE;AAAxB;AAAZ,WACI,gCAAC,4BAAD;AAAkB,UAAA,IAAI,EAAE,KAAKvF,KAAL,CAAWuC,IAAnC;AAAyC,UAAA,gBAAgB,EAAE,KAAKjB,sDAAhE;AAC4B,UAAA,iBAAiB,EAAE,KAAKtB,KAAL,CAAW6D,iBAD1D;AAE4B,UAAA,mBAAmB,EAAE,KAAK7D,KAAL,CAAWgD,mBAF5D;AAG4B,UAAA,QAAQ,EAAE,KAAKhD,KAAL,CAAWwF,QAHjD;AAI4B,UAAA,SAAS,EAAE,KAAKvF,KAAL,CAAWE,SAJlD;AAK4B,UAAA,iBAAiB,EAAE,KAAKH,KAAL,CAAW8B,iBAL1D;AAM4B,UAAA,SAAS,EAAE,KAAK9B,KAAL,CAAW+B,SANlD;AAO4B,UAAA,qBAAqB,EAAE,KAAK/B,KAAL,CAAWgC,qBAP9D;AAQ4B,UAAA,2BAA2B,EAAE,KAAKhC,KAAL,CAAWiC,2BARpE;AAS4B,UAAA,oBAAoB,EAAE,KAAKhB;AATvD,UADJ,CADJ;AAeH,OAhBD,MAgBO,IAAG,KAAKhB,KAAL,CAAWC,gBAAX,CAA4B8E,aAA5B,CAA0C,mBAA1C,KAAkE,CAArE,EAAwE;AAC3E,eACI;AAAK,UAAA,KAAK,EAAE;AAACM,YAAAA,KAAK,EAAE,MAAR;AAAgBC,YAAAA,MAAM,EAAE;AAAxB;AAAZ,WACI,gCAAC,+BAAD;AAAqB,UAAA,IAAI,EAAE,KAAKvF,KAAL,CAAWuC,IAAtC;AAA4C,UAAA,aAAa,EAAE,KAAKnB,aAAhE;AAC4B,UAAA,MAAM,EAAE,KAAKpB,KAAL,CAAWwF,QAD/C;AAE4B,UAAA,cAAc,EAAE,CAAC;AAACb,YAAAA,KAAK,EAAE,KAAK3E,KAAL,CAAWyF;AAAnB,WAAD,CAF5C;AAG4B,UAAA,eAAe,EAAE,KAAKzF,KAAL,CAAWwF,QAHxD;AAI4B,UAAA,kBAAkB,EAAE,KAAK/D,WAJrD;AAK4B,UAAA,0BAA0B,EAAE,KAAKJ,4BAL7D;AAM4B,UAAA,8BAA8B,EAAE,KAAKE,mBANjE;AAO4B,UAAA,MAAM,EAAE,KAAKtB,KAAL,CAAWG,MAAX,CAAkB,KAAKH,KAAL,CAAWQ,kBAA7B,KAAoD4D,SAApD,GAAgE,KAAKpE,KAAL,CAAWG,MAAX,CAAkB,KAAKH,KAAL,CAAWQ,kBAA7B,CAAhE,GAAmH,EAPvJ;AAQ4B,UAAA,MAAM,EAAE,KAAKR,KAAL,CAAWW,MAR/C;AAS4B,UAAA,iBAAiB,EAAE,KAAKZ,KAAL,CAAW8B,iBAT1D;AAU4B,UAAA,SAAS,EAAE,KAAK9B,KAAL,CAAW+B,SAVlD;AAW4B,UAAA,qBAAqB,EAAE,KAAK/B,KAAL,CAAWgC,qBAX9D;AAY4B,UAAA,2BAA2B,EAAE,KAAKhC,KAAL,CAAWiC;AAZpE,UADJ,CADJ;AAkBH;AACJ;;;;EArQ6CyD,kBAAMC,S","sourcesContent":["import React from 'react';\n\nimport CrearFuenteDatos from './CrearFuenteDatos.js';\nimport InstruccionVariable from '../../../InstruccionVariable.js';\n\nvar campo;\n\n/*              ARREGLO DE ATRIBUTOS               */\n/* CADA POSICION REPRESENTA UN CAMPO / ATRIBUTO / COLUMNA */\n/*\n    [ {nombre: \"Carlos\", apellido: \"Carlos\"}, {nombre: \"Perez\", apellido: \"Perez\"} ]\n*/\n\n/*              ARREGLO DE REGLAS               */\n/* CADA POSICION REPRESENTA UNA REGLA PERTENECIENTE A AL ATRIBUTO CORRESPONDIENTE A LA POSICION DEL ATRIBUTO */\n/*\n    [ [{nombre: \"Carlos\", apellido: \"Carlos\"}, {nombre: \"Perez\", apellido: \"Perez\"}], [{nombre: \"Carlos1\", apellido: \"Carlos1\"}, {nombre: \"Perez2\", apellido: \"Perez2\"}] ]\n*/\n\n/*              ARREGLO DE FORMULAS               */\n/* CADA POSICION REPRESENTA UNA FORMULA PERTENECIENTE A AL ATRIBUTO CORRESPONDIENTE A LA POSICION DEL ATRIBUTO */\n/*\n    [ [{nombre: \"Carlos\", apellido: \"Carlos\"}, {nombre: \"Perez\", apellido: \"Perez\"}], [{nombre: \"Carlos1\", apellido: \"Carlos1\"}, {nombre: \"Perez2\", apellido: \"Perez2\"}] ]\n*/\n\nexport default class CrearFuenteDatosHome extends React.Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            componenteActual: 'crearFuente',\n            atributos: [],\n            reglas: [ [{texto: \"Regla 1\", nivel: 1, esCondicion: false}, {texto: \"Regla 2\", nivel: 2, esCondicion: true}, {texto: \"Regla 3\", nivel: 3, esCondicion: false}, {texto: \"Regla 4\", nivel: 1, esCondicion: false}, {texto: \"Regla 5\", nivel: 2, esCondicion: false}] ],\n            formulas: [],\n            indiceSeleccionado: -1,\n            tipoIndiceSeleccionado: '',                   //esOtraRegla, arriba, abajo\n            posicionNuevoAtributo: 0,                     //posicion del arreglo donde se debe insertar el siguiente atributo / campo /  columna (para controlar cuando se agrega condiciones / instrucciones a un nuevo atributo)\n            esCondicion: true,                             //bandera para estado de nueva regla / instruccion, saber si es nueva comparacion o asignacion\n            navbar: \"\"\n        }\n        this.loadRules = this.loadRules.bind(this);\n        this.sortRules = this.sortRules.bind(this);\n        this.returnToCreateDataSource = this.returnToCreateDataSource.bind(this);\n        this.goToCreateConditions = this.goToCreateConditions.bind(this);\n        this.createDataSource = this.createDataSource.bind(this);\n        this.getDataSourceID = this.getDataSourceID.bind(this);\n        this.retornarCampo = this.retornarCampo.bind(this);\n        this.actualizarIndiceSeleccionado = this.actualizarIndiceSeleccionado.bind(this);\n        this.actualizarIndiceSeleccionadoIrCondicionesNuevoAtributo = this.actualizarIndiceSeleccionadoIrCondicionesNuevoAtributo.bind(this);\n        this.actualizarCondicion = this.actualizarCondicion(this);\n        this.anadirAtributo = this.anadirAtributo.bind(this);\n        this.anadirRegla = this.anadirRegla.bind(this);\n    }\n\n    componentDidMount () {\n    }\n\n    loadRules() {\n        //FINISH\n        this.sortRules();\n    }\n\n    sortRules() {\n        var tempCopy = [...this.state.reglas];\n        for (var i = 0; i < tempCopy.length; i++) {\n            tempCopy[i]\n        };\n    }\n\n    returnToCreateDataSource () {\n        this.setState({\n            componenteActual: \"crearFuente\"\n        });\n    }\n\n    goToCreateConditions () {\n        var navbar = <div className={\"row\"}>\n            <div className={\"col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12\"}>\n                <div className={\"page-header\"}>\n                    <h2 className={\"pageheader-title\"}>Condiciones</h2>\n                    <div className={\"page-breadcrumb\"}>\n                        <nav aria-label=\"breadcrumb\">\n                            <ol className={\"breadcrumb\"}>\n                                <li className={\"breadcrumb-item font-16\"} aria-current=\"page\" onClick={this.props.configuracionHome}><a href=\"#\" className={\"breadcrumb-link\"}>Configuraci&oacute;n</a></li>\n                                <li className={\"breadcrumb-item font-16\"} aria-current=\"page\" onClick={this.props.goOptions}><a href=\"#\" className={\"breadcrumb-link\"}>Tipo de Variable</a></li>\n                                <li className={\"breadcrumb-item font-16\"} aria-current=\"page\" onClick={this.props.retornoSeleccionTabla}><a href=\"#\" className={\"breadcrumb-link\"}>Tablas</a></li>\n                                <li className={\"breadcrumb-item font-16\"} aria-current=\"page\" onClick={this.props.retornoSeleccionFuenteDatos}><a href=\"#\" className={\"breadcrumb-link\"}>Fuentes de Datos</a></li>\n                                <li className={\"breadcrumb-item font-16\"} aria-current=\"page\" onClick={this.returnToCreateDataSource}><a href=\"#\" className={\"breadcrumb-link\"}>Crear Fuente de Datos</a></li>\n                                <li className={\"breadcrumb-item active font-16\"} aria-current=\"page\">Condiciones</li>\n                            </ol>\n                        </nav>\n                    </div>\n                </div>\n            </div>\n        </div>;\n        this.setState({\n            componenteActual: \"fuenteCondiciones\",\n            navbar: navbar\n        });\n    }\n\n    createDataSource (fuenteDato, atributoFuenteDato) {\n        //validaciones existe por lo menos regla asignar\n        const transaction = new sql.Transaction( this.props.pool );\n        transaction.begin(err => {\n            var rolledBack = false;\n            transaction.on('rollback', aborted => {\n                rolledBack = true;\n            });\n            const request = new sql.Request(transaction);\n            request.query(\"insert into FuenteDatos (tablaID, nombre, descripcion, esObjeto, guardar, nivel) values (\"+this.props.idTablaSeleccionada+\", '\"+fuenteDato.nombre+\"', '\"+fuenteDato.descripcion+\"', '\"+fuenteDato.esObjeto+\"', \"+fuenteDato.objetoPadreID+\", '\"+fuenteDato.guardar+\"', 0)\", (err, result) => {\n                if (err) {\n                    if (!rolledBack) {\n                        console.log(err);\n                        transaction.rollback(err => {\n                        });\n                    }\n                } else {\n                    transaction.commit(err => {\n                        this.props.getDataSourceID(atributoFuenteDato);\n                    });\n                }\n            });\n        }); // fin transaction\n    }\n\n    getDataSourceID (fuenteDato, atributoFuenteDato) {\n        //validaciones existe por lo menos regla asignar\n        const transaction = new sql.Transaction( this.props.pool );\n        transaction.begin(err => {\n            var rolledBack = false;\n            transaction.on('rollback', aborted => {\n                rolledBack = true;\n            });\n            const request = new sql.Request(transaction);\n            request.query(\"insert into Campos (tablaID, nombre, tipo, guardar, formula, nivel) values (\"+this.props.idTablaSeleccionada+\", '\"+nombre+\"', '\"+tipo+\"', '\"+guardar+\"', '\"+formula+\"', \"+nivel+\")\", (err, result) => {\n                if (err) {\n                    if (!rolledBack) {\n                        console.log(err);\n                        transaction.rollback(err => {\n                        });\n                    }\n                } else {\n                    transaction.commit(err => {\n                        this.props.terminoCrearCampo(nombre);\n                    });\n                }\n            });\n        }); // fin transaction\n    }\n\n    retornarCampo (campoNuevo) {\n        campo = campoNuevo;\n    }\n\n    actualizarIndiceSeleccionado (indice, tipoIndice) {\n        this.setState({\n            indiceSeleccionado: indice,\n            tipoIndiceSeleccionado: tipoIndice\n        });\n    }\n\n    actualizarIndiceSeleccionadoIrCondicionesNuevoAtributo () {\n        this.setState({\n            indiceSeleccionado: -1,\n            tipoIndiceSeleccionado: ''\n        }, this.props.showCondicionVar );\n    }\n\n    actualizarCondicion (esCondicion) {\n        this.setState({\n            esCondicion: esCondicion\n        });\n    }\n\n    anadirAtributo () {\n        var nombreAtributo = $(\"#nombreAtributo\").val();\n        //si no existen condiciones creadas, que se cree un arreglo vacio\n        if(this.state.reglas[this.state.posicionNuevoAtributo] == undefined) {\n            var tempCopyRules = [...this.state.reglas];\n            tempCopyRules.push([]);\n            this.setState({\n                reglas: tempCopyRules\n            });\n        }\n        //si no existen formulas creadas, que se cree un arreglo vacio\n        if(this.state.formula[this.state.posicionNuevoAtributo] == undefined) {\n            var tempCopyFormulas = [...this.state.formula];\n            tempCopyFormulas.push([]);\n            this.setState({\n                formula: tempCopyFormulas\n            });\n        }\n        var nuevoAtributo;\n        //si la formula ya fue asignada, no agregar tipo\n        if(this.state.atributos[this.state.posicionNuevoAtributo] == undefined) {\n            nuevoAtributo = {nombre: nombreAtributo, tipo: ''};\n        } else {\n            nuevoAtributo = this.state.atributos[this.state.posicionNuevoAtributo];\n            nuevoAtributo.nombre = nombreAtributo;\n        }\n        var tempCopy = [...this.state.atributos];\n        tempCopy.push(nuevoAtributo);\n        this.setState({\n            atributos: tempCopy\n        });\n    }\n\n    anadirRegla () {\n        //si se agrega una formula/asignacion, todas las otras formulas tienen que ser del mismo tipo para esa variable\n        //si el indiceSeleccionado es igual a -1, se llamo desde nuevo atributo\n        //sino, modificar elemento seleccionado\n        //primer if: ver el estado de donde fue llamado el metodo\n        if(this.state.esCondicion) {\n            //\n        } else {\n            //\n        }\n        if( this.state.indiceSeleccionado != -1 || (this.state.indiceSeleccionado == -1 && this.state.reglas.length == 0) ) {\n            var operacion = $(\"input[name='operacionRadio']:checked\").val();\n            var valor = $(\"#valor\").val();\n            console.log('operacion');\n            console.log(operacion);\n            console.log('valor');\n            console.log(valor);\n            console.log('campo');\n            console.log(campo);\n            var posicionAInsertar = -1;\n            if(this.state.indiceSeleccionado != -1) {\n                posicionAInsertar = this.state.indiceSeleccionado;\n            }\n            var copiaAntiguaReglas = [...this.state.reglas];\n            var nuevaRegla = {campo: campo.valor, operacion: operacion, valor: valor, texto: \"TEXTO\", reglaPadreID: -1, nivel: 1};\n            if(posicionAInsertar != -1) {\n                copiaAntiguaReglas.push(nuevaRegla);\n            } else {\n                if(this.state.tipoIndiceSeleccionado.localeCompare(\"esOtraRegla\") == 0) {\n                    var variablePadre = this.state.reglas[posicionAInsertar]\n                    nuevaRegla.reglaPadreID = variablePadre.ID;\n                    nuevaRegla.nivel = variablePadre.nivel + 1;\n                    var tempCopy\n                    this.actualizarNivelReglas(nuevaRegla, posicionInsertarNuevo, )\n                } if(this.state.tipoIndiceSeleccionado.localeCompare(\"arriba\") == 0) {\n                }\n            }\n        } else {\n            alert(\"Seleccione una posición para agregar una nueva instrucción\");\n        }\n    }\n    \n    render() {\n        if(this.state.componenteActual.localeCompare(\"crearFuente\") == 0) {\n            return (\n                <div style={{width: \"100%\", height: \"100%\"}}>\n                    <CrearFuenteDatos pool={this.props.pool} showCondicionVar={this.actualizarIndiceSeleccionadoIrCondicionesNuevoAtributo}\n                                                terminoCrearCampo={this.props.terminoCrearCampo}\n                                                idTablaSeleccionada={this.props.idTablaSeleccionada}\n                                                columnas={this.props.columnas}\n                                                atributos={this.state.atributos}\n                                                configuracionHome={this.props.configuracionHome}\n                                                goOptions={this.props.goOptions}\n                                                retornoSeleccionTabla={this.props.retornoSeleccionTabla}\n                                                retornoSeleccionFuenteDatos={this.props.retornoSeleccionFuenteDatos}\n                                                goToCreateConditions={this.goToCreateConditions}>\n                    </CrearFuenteDatos>\n                </div>\n            );\n        } else if(this.state.componenteActual.localeCompare(\"fuenteCondiciones\") == 0) {\n            return (\n                <div style={{width: \"100%\", height: \"100%\"}}>\n                    <InstruccionVariable pool={this.props.pool} retornarCampo={this.retornarCampo}\n                                                campos={this.props.columnas}\n                                                camposDropdown={[{valor: this.props.nombreTablaSeleccionada}]}\n                                                valoresDropdown={this.props.columnas}\n                                                callbackCrearRegla={this.anadirRegla}\n                                                retornarIndiceSeleccionado={this.actualizarIndiceSeleccionado}\n                                                retornarEstadoVistaEsCondicion={this.actualizarCondicion}\n                                                reglas={this.state.reglas[this.state.indiceSeleccionado] != undefined ? this.state.reglas[this.state.indiceSeleccionado] : []}\n                                                navbar={this.state.navbar}\n                                                configuracionHome={this.props.configuracionHome}\n                                                goOptions={this.props.goOptions}\n                                                retornoSeleccionTabla={this.props.retornoSeleccionTabla}\n                                                retornoSeleccionFuenteDatos={this.props.retornoSeleccionFuenteDatos}>\n                    </InstruccionVariable>\n                </div>\n            );\n        }\n    }\n}\n"],"file":"CrearFuenteDatosHome.js"}