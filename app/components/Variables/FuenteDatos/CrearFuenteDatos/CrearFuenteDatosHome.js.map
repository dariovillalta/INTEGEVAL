{"version":3,"sources":["components/Variables/FuenteDatos/CrearFuenteDatos/CrearFuenteDatosHome.js"],"names":["campo","CrearFuenteDatosHome","props","state","componenteActual","reglas","navbar","returnToCreateDataSource","bind","goToCreateConditions","createDataSource","getDataSourceID","setState","configuracionHome","goOptions","retornoSeleccionTabla","retornoSeleccionFuenteDatos","fuenteDato","atributoFuenteDato","transaction","sql","Transaction","pool","begin","err","rolledBack","on","aborted","request","Request","query","idTablaSeleccionada","nombre","descripcion","esObjeto","objetoPadreID","guardar","result","console","log","rollback","commit","tipo","formula","nivel","terminoCrearCampo","campoNuevo","operacion","$","val","valor","copiaAntiguaReglas","nuevaRegla","push","localeCompare","width","height","showCondicionVar","columnas","retornarCampo","nombreTablaSeleccionada","anadirRegla","React","Component"],"mappings":"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","sourcesContent":["import React from 'react';\n\nimport CrearFuenteDatos from './CrearFuenteDatos.js';\nimport CondicionVariable from '../../../CondicionVariable.js';\n\nvar campo;\n\nexport default class CrearFuenteDatosHome extends React.Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            componenteActual: 'crearFuente',\n            reglas: [],\n            navbar: \"\"\n        }\n        this.returnToCreateDataSource = this.returnToCreateDataSource.bind(this);\n        this.goToCreateConditions = this.goToCreateConditions.bind(this);\n        this.createDataSource = this.createDataSource.bind(this);\n        this.getDataSourceID = this.getDataSourceID.bind(this);\n        this.goToCreateConditions = this.goToCreateConditions.bind(this);\n    }\n\n    componentDidMount () {\n    }\n\n    returnToCreateDataSource () {\n        this.setState({\n            componenteActual: \"crearFuente\"\n        });\n    }\n\n    goToCreateConditions () {\n        var navbar = <div className={\"row\"}>\n            <div className={\"col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12\"}>\n                <div className={\"page-header\"}>\n                    <h2 className={\"pageheader-title\"}>Condiciones</h2>\n                    <div className={\"page-breadcrumb\"}>\n                        <nav aria-label=\"breadcrumb\">\n                            <ol className={\"breadcrumb\"}>\n                                <li className={\"breadcrumb-item font-16\"} aria-current=\"page\" onClick={this.props.configuracionHome}><a href=\"#\" className={\"breadcrumb-link\"}>Configuraci&oacute;n</a></li>\n                                <li className={\"breadcrumb-item font-16\"} aria-current=\"page\" onClick={this.props.goOptions}><a href=\"#\" className={\"breadcrumb-link\"}>Tipo de Variable</a></li>\n                                <li className={\"breadcrumb-item font-16\"} aria-current=\"page\" onClick={this.props.retornoSeleccionTabla}><a href=\"#\" className={\"breadcrumb-link\"}>Tablas</a></li>\n                                <li className={\"breadcrumb-item font-16\"} aria-current=\"page\" onClick={this.props.retornoSeleccionFuenteDatos}><a href=\"#\" className={\"breadcrumb-link\"}>Fuentes de Datos</a></li>\n                                <li className={\"breadcrumb-item font-16\"} aria-current=\"page\" onClick={this.returnToCreateDataSource}><a href=\"#\" className={\"breadcrumb-link\"}>Crear Fuente de Datos</a></li>\n                                <li className={\"breadcrumb-item active font-16\"} aria-current=\"page\">Condiciones</li>\n                            </ol>\n                        </nav>\n                    </div>\n                </div>\n            </div>\n        </div>;\n        this.setState({\n            componenteActual: \"fuenteCondiciones\",\n            navbar: navbar\n        });\n    }\n\n    createDataSource (fuenteDato, atributoFuenteDato) {\n        //validaciones existe por lo menos regla asignar\n        const transaction = new sql.Transaction( this.props.pool );\n        transaction.begin(err => {\n            var rolledBack = false;\n            transaction.on('rollback', aborted => {\n                rolledBack = true;\n            });\n            const request = new sql.Request(transaction);\n            request.query(\"insert into FuenteDatos (tablaID, nombre, descripcion, esObjeto, guardar, nivel) values (\"+this.props.idTablaSeleccionada+\", '\"+fuenteDato.nombre+\"', '\"+fuenteDato.descripcion+\"', '\"+fuenteDato.esObjeto+\"', \"+fuenteDato.objetoPadreID+\", '\"+fuenteDato.guardar+\"', 0)\", (err, result) => {\n                if (err) {\n                    if (!rolledBack) {\n                        console.log(err);\n                        transaction.rollback(err => {\n                        });\n                    }\n                } else {\n                    transaction.commit(err => {\n                        this.props.getDataSourceID(atributoFuenteDato);\n                    });\n                }\n            });\n        }); // fin transaction\n    }\n\n    getDataSourceID (fuenteDato, atributoFuenteDato) {\n        //validaciones existe por lo menos regla asignar\n        const transaction = new sql.Transaction( this.props.pool );\n        transaction.begin(err => {\n            var rolledBack = false;\n            transaction.on('rollback', aborted => {\n                rolledBack = true;\n            });\n            const request = new sql.Request(transaction);\n            request.query(\"insert into Campos (tablaID, nombre, tipo, guardar, formula, nivel) values (\"+this.props.idTablaSeleccionada+\", '\"+nombre+\"', '\"+tipo+\"', '\"+guardar+\"', '\"+formula+\"', \"+nivel+\")\", (err, result) => {\n                if (err) {\n                    if (!rolledBack) {\n                        console.log(err);\n                        transaction.rollback(err => {\n                        });\n                    }\n                } else {\n                    transaction.commit(err => {\n                        this.props.terminoCrearCampo(nombre);\n                    });\n                }\n            });\n        }); // fin transaction\n    }\n\n    retornarCampo (campoNuevo) {\n        campo = campoNuevo;\n    }\n\n    anadirRegla () {\n        var operacion = $(\"input[name='operacionRadio']:checked\").val();\n        var valor = $(\"#valor\").val();\n        console.log('operacion');\n        console.log(operacion);\n        console.log('valor');\n        console.log(valor);\n        console.log('campo');\n        console.log(campo);\n        var copiaAntiguaReglas = [...this.state.reglas];\n        var nuevaRegla = {campo: campo.valor, operacion: operacion, valor: valor};\n        copiaAntiguaReglas.push();\n    }\n    \n    render() {\n        if(this.state.componenteActual.localeCompare(\"crearFuente\") == 0) {\n            return (\n                <div style={{width: \"100%\", height: \"100%\"}}>\n                    <CrearFuenteDatos pool={this.props.pool} showCondicionVar={this.props.showCondicionVar}\n                                                terminoCrearCampo={this.props.terminoCrearCampo}\n                                                idTablaSeleccionada={this.props.idTablaSeleccionada}\n                                                columnas={this.props.columnas}\n                                                configuracionHome={this.props.configuracionHome}\n                                                goOptions={this.props.goOptions}\n                                                retornoSeleccionTabla={this.props.retornoSeleccionTabla}\n                                                retornoSeleccionFuenteDatos={this.props.retornoSeleccionFuenteDatos}\n                                                goToCreateConditions={this.goToCreateConditions}>\n                    </CrearFuenteDatos>\n                </div>\n            );\n        } else if(this.state.componenteActual.localeCompare(\"fuenteCondiciones\") == 0) {\n            return (\n                <div style={{width: \"100%\", height: \"100%\"}}>\n                    <CondicionVariable pool={this.props.pool} retornarCampo={this.retornarCampo}\n                                                campos={this.props.columnas}\n                                                camposDropdown={[{valor: this.props.nombreTablaSeleccionada}]}\n                                                valoresDropdown={this.props.columnas}\n                                                callbackCrearRegla={this.anadirRegla}\n                                                navbar={this.state.navbar}\n                                                configuracionHome={this.props.configuracionHome}\n                                                goOptions={this.props.goOptions}\n                                                retornoSeleccionTabla={this.props.retornoSeleccionTabla}\n                                                retornoSeleccionFuenteDatos={this.props.retornoSeleccionFuenteDatos}>\n                    </CondicionVariable>\n                </div>\n            );\n        }\n    }\n}\n"],"file":"CrearFuenteDatosHome.js"}