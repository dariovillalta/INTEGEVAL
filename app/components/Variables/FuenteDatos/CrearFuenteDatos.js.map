{"version":3,"sources":["components/Variables/FuenteDatos/CrearFuenteDatos.js"],"names":["nombreCampoSeleccionado","tipoCampos","nombre","CrearFuenteDatos","props","state","atributos","mostrarEsObjeto","titulo","crearFuenteDato","bind","retornoSeleccionVariable","cambioAObjeto","cambiarTitulo","$","val","tipo","guardar","is","formula","nivel","console","log","idTablaSeleccionada","transaction","sql","Transaction","pool","begin","err","rolledBack","on","aborted","request","Request","query","result","rollback","commit","terminoCrearCampo","variable","length","setState","configuracionHome","width","margin","display","map","i","border","columnas","crearAtributoDeObjeto","alignItems","justifyContent","color","React","Component"],"mappings":"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","sourcesContent":["import React from 'react';\nimport sql from 'mssql';\n\nimport ListasSeleVariable from '../../ListasSeleVariable.js';\nimport CrearFuenteDatosAtributos from './CrearFuenteDatosAtributos.js';\n\nvar nombreCampoSeleccionado = '';\nconst tipoCampos = [ {nombre: \"texto\"}, {nombre: \"booleano\"}, {nombre: \"fecha\"}, {nombre: \"nÃºmero\"}, {nombre: \"arreglo\"}];\n\nexport default class CrearFuenteDatos extends React.Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            atributos: [],\n            mostrarEsObjeto: true,\n            titulo: \"Valores Multiples\"\n        }\n        this.crearFuenteDato = this.crearFuenteDato.bind(this);\n        this.retornoSeleccionVariable = this.retornoSeleccionVariable.bind(this);\n        this.cambioAObjeto = this.cambioAObjeto.bind(this);\n        this.cambiarTitulo = this.cambiarTitulo.bind(this);\n    }\n\n    crearFuenteDato () {\n        var nombre = $(\"#nombreFuenteDato\").val();\n        var tipo = $(\"#tipoFuenteDato\").val();\n        var guardar;\n        if ($(\"#guardarFuenteDato\").is(':checked'))\n            guardar = true;\n        else\n            guardar = false;\n        var formula = nombreCampoSeleccionado;\n        var nivel = 0;\n        console.log('this.props.idTablaSeleccionada');\n        console.log(this.props.idTablaSeleccionada);\n        console.log('nombre');\n        console.log(nombre);\n        console.log('tipo');\n        console.log(tipo);\n        console.log('guardar');\n        console.log(guardar);\n        console.log('formula');\n        console.log(formula);\n        const transaction = new sql.Transaction( this.props.pool );\n        transaction.begin(err => {\n            var rolledBack = false;\n            transaction.on('rollback', aborted => {\n                rolledBack = true;\n            });\n            const request = new sql.Request(transaction);\n            request.query(\"insert into Campos (tablaID, nombre, tipo, guardar, formula, nivel) values (\"+this.props.idTablaSeleccionada+\", '\"+nombre+\"', '\"+tipo+\"', '\"+guardar+\"', '\"+formula+\"', \"+nivel+\")\", (err, result) => {\n                if (err) {\n                    if (!rolledBack) {\n                        console.log(err);\n                        transaction.rollback(err => {\n                        });\n                    }\n                } else {\n                    transaction.commit(err => {\n                        this.props.terminoCrearCampo(nombre);\n                    });\n                }\n            });\n        }); // fin transaction\n    }\n\n    retornoSeleccionVariable (variable) {\n        nombreCampoSeleccionado = '';\n        if(variable[0].nombre.length > 0) {\n            nombreCampoSeleccionado = variable[0].nombre;\n        }\n    }\n\n    cambioAObjeto () {\n        this.setState({\n            mostrarEsObjeto: !this.state.mostrarEsObjeto\n        }, this.cambiarTitulo );\n    }\n\n    cambiarTitulo () {\n        if(this.state.mostrarEsObjeto) {\n            this.setState({\n                titulo: \"Valores Multiples\"\n            });\n        } else  {\n            this.setState({\n                titulo: \"Valor Ãnico\"\n            });\n        }\n    }\n\n    render() {\n        return (\n            <div>\n                <div className={\"row\"}>\n                    <div className={\"col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12\"}>\n                        <div className={\"page-header\"}>\n                            <h2 className={\"pageheader-title\"}>Crear Riesgo</h2>\n                            <div className={\"page-breadcrumb\"}>\n                                <nav aria-label=\"breadcrumb\">\n                                    <ol className={\"breadcrumb\"}>\n                                        <li className={\"breadcrumb-item font-16\"} aria-current=\"page\" onClick={this.props.configuracionHome}><a href=\"#\" className={\"breadcrumb-link\"}>Configuraci&oacute;n</a></li>\n                                        <li className={\"breadcrumb-item active font-16\"} aria-current=\"page\">Crear Fuente de Datos</li>\n                                    </ol>\n                                </nav>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div className={\"row\"}>\n                    <div className={\"col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12\"}>\n                        <div className={\"card influencer-profile-data\"}>\n                            <div className={\"card-body\"}>\n                                <div className={\"border-top border-bottom addPaddingToConfig\"} style={{width: \"100%\"}}>\n                                    <div className={\"row\"} style={{width: \"100%\"}}>\n                                        <div className={\"col-xl-3 col-lg-3 col-md-3 col-sm-3 col-3 form-group\"}>\n                                            <label htmlFor=\"nombreFuenteDato\" className=\"col-form-label\">Nombre Fuente de Dato (Variable Origen)</label>\n                                        </div>\n                                        <div className={\"col-xl-9 col-lg-9 col-md-9 col-sm-9 col-9 form-group\"}>\n                                            <input id=\"nombreFuenteDato\" type=\"text\" className=\"form-control form-control-sm\"/>\n                                        </div>\n                                    </div>\n                                    <div className={\"row\"} style={{width: \"100%\"}}>\n                                        <div className={\"col-xl-3 col-lg-3 col-md-3 col-sm-3 col-3 form-group\"}>\n                                            <label htmlFor=\"esObjetoFuenteDato\" className=\"col-form-label\">Tiene mÃ¡s de un atributo / propiedad:</label>\n                                        </div>\n                                        <div className={\"col-xl-9 col-lg-9 col-md-9 col-sm-9 col-9 form-group\"}>\n                                            <div className={\"switch-button-variable switch-button-yesno\"} style={{margin:\"0 auto\", display:\"block\"}}>\n                                                <input type=\"checkbox\" defaultChecked name={\"esObjetoFuenteDato\"} id={\"esObjetoFuenteDato\"} onClick={this.cambioAObjeto}/><span>\n                                                <label htmlFor={\"esObjetoFuenteDato\"}></label></span>\n                                            </div>\n                                        </div>\n                                    </div>\n                                    <div className={\"row\"} style={{width: \"100%\"}}>\n                                        <div className={\"col-xl-3 col-lg-3 col-md-3 col-sm-3 col-3 form-group\"}>\n                                            <label htmlFor=\"guardarFuenteDato\" className=\"col-form-label\">Guardar Valores Obtenidos en Base de Datos</label>\n                                        </div>\n                                        <div className={\"col-xl-9 col-lg-9 col-md-9 col-sm-9 col-9 form-group\"}>\n                                            <br/>\n                                            <div className={\"switch-button switch-button-yesno\"} style={{margin:\"0 auto\", display:\"block\"}}>\n                                                <input type=\"checkbox\" defaultChecked name={\"guardarFuenteDato\"} id={\"guardarFuenteDato\"}/><span>\n                                                <label htmlFor={\"guardarFuenteDato\"}></label></span>\n                                            </div>\n                                        </div>\n                                    </div>\n                                    <div className={\"row\"} style={{width: \"100%\"}}>\n                                        <div className={\"col-xl-3 col-lg-3 col-md-3 col-sm-3 col-3 form-group\"}>\n                                            <label htmlFor=\"tipoFuenteDato\" className=\"col-form-label\">Tipo de Variable</label>\n                                        </div>\n                                        <div className={\"col-xl-9 col-lg-9 col-md-9 col-sm-9 col-9 form-group\"}>\n                                            <select id=\"tipoFuenteDato\" className=\"form-control\">\n                                                {tipoCampos.map((tipo, i) =>\n                                                    <option value={tipo.nombre} key={tipo.nombre}>{tipo.nombre}</option>\n                                                )}\n                                            </select>\n                                        </div>\n                                    </div>\n                                    <br/>\n                                    <div className={\"row\"} style={{width: \"100%\", border: \"1px solid #e6e6f2\"}}>\n                                        <CrearFuenteDatosAtributos atributos={this.state.atributos} campos={this.props.columnas} titulo={this.state.titulo} mostrarEsObjeto={this.state.mostrarEsObjeto} terminarCrearAtributo={this.crearAtributoDeObjeto}> </CrearFuenteDatosAtributos>\n                                    </div>\n                                    <br/>\n                                    { !this.state.mostrarEsObjeto ? (\n                                        <div>\n                                            <div className={\"row\"} style={{display: \"flex\", alignItems: \"center\", justifyContent: \"center\"}}>\n                                                <a className={\"btn btn-primary btnWhiteColorHover font-bold font-20\"} style={{color: \"#fafafa\"}} onClick={this.crearFuenteDato}>Crear</a>\n                                            </div>\n                                            <br/>\n                                        </div>\n                                    ) : (\n                                        null\n                                    )}\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        );\n    }\n}\n"],"file":"CrearFuenteDatos.js"}