{"version":3,"sources":["components/Riesgos/RiesgoHome.js"],"names":["isMounted","RiesgoHome","props","state","idRiesgoSeleccionado","componenteActual","crearRiesgo","bind","retornoSeleccionRiesgoSameComponent","retornoSeleccionRiesgoDiffComponent","editarRiesgo","retornoEditarRiesgo","terminoCrearRiesgoPasarAEdit","setState","showRiesgos","self","setTimeout","id","nombreRiesgo","pesoRiesgo","toleranciaRiesgo","valorIdealRiesgo","padreRiesgo","console","log","transaction","sql","Transaction","pool","begin","err","rolledBack","on","aborted","request","Request","query","result","rollback","commit","recordset","undefined","length","ID","nombre","peso","tolerancia","valorIdeal","idRiesgoPadre","localeCompare","configuracionHome","showFormula","showCondicionVar","updateNavBar","showUmbralHome","updateFormula","React","Component"],"mappings":"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","sourcesContent":["import React from 'react';\nimport sql from 'mssql';\n\nimport SeleccionarRiesgo from './SeleccionarRiesgo.js';\nimport CrearRiesgo from './CrearRiesgo.js';\nimport EditarRiesgo from './EditarRiesgo.js';\n\nvar isMounted = false;\n\nexport default class RiesgoHome extends React.Component {\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            idRiesgoSeleccionado: -1,\n            componenteActual: \"selRiesgo\"\n        }\n        this.crearRiesgo = this.crearRiesgo.bind(this);\n        this.retornoSeleccionRiesgoSameComponent = this.retornoSeleccionRiesgoSameComponent.bind(this);\n        this.retornoSeleccionRiesgoDiffComponent = this.retornoSeleccionRiesgoDiffComponent.bind(this);\n        this.editarRiesgo = this.editarRiesgo.bind(this);\n        this.retornoEditarRiesgo = this.retornoEditarRiesgo.bind(this);\n        this.terminoCrearRiesgoPasarAEdit = this.terminoCrearRiesgoPasarAEdit.bind(this);\n    }\n\n    componentDidMount() {\n        isMounted = true;\n    }\n    componentWillUnmount() {\n        isMounted = false;\n    }\n\n    crearRiesgo () {\n        this.setState({\n            componenteActual: \"crearRiesgo\"\n        });\n    }\n\n    retornoSeleccionRiesgoSameComponent () {\n        this.setState({\n            idRiesgoSeleccionado: -1,\n            componenteActual: \"selRiesgo\"\n        });\n    }\n\n    retornoSeleccionRiesgoDiffComponent () {\n        this.props.showRiesgos();\n        var self = this;\n        setTimeout(function(){\n            self.setState({\n                idRiesgoSeleccionado: -1,\n                componenteActual: \"selRiesgo\"\n            });\n        }, 500);\n    }\n\n    editarRiesgo (id, nombreRiesgo, pesoRiesgo, toleranciaRiesgo, valorIdealRiesgo, padreRiesgo) {\n        this.setState({\n            idRiesgoSeleccionado: id,\n            componenteActual: \"editarRiesgo\",\n            nombreRiesgo: nombreRiesgo,\n            pesoRiesgo: pesoRiesgo,\n            toleranciaRiesgo: toleranciaRiesgo,\n            valorIdealRiesgo: valorIdealRiesgo,\n            padreRiesgo: padreRiesgo\n        });\n    }\n\n    retornoEditarRiesgo () {\n        this.props.showRiesgos();\n        var self = this;\n        if(isMounted) {\n            console.log(\"SI\")\n        } else {\n            console.log(\"NO\")\n        }\n        setTimeout(function(){\n            if(isMounted) {\n                console.log(\"SI\")\n            } else {\n                console.log(\"NO\")\n            }\n            console.log(self)\n            self.setState({\n                componenteActual: \"editarRiesgo\"\n            });\n        }, 3500);\n    }\n\n    terminoCrearRiesgoPasarAEdit (nombreRiesgo) {\n        console.log(\"despues retorno\");\n        const transaction = new sql.Transaction( this.props.pool );\n        transaction.begin(err => {\n            var rolledBack = false;\n            transaction.on('rollback', aborted => {\n                rolledBack = true;\n            });\n            const request = new sql.Request(transaction);\n            request.query(\"select * from Riesgos where nombre = '\"+nombreRiesgo+\"'\", (err, result) => {\n                if (err) {\n                    if (!rolledBack) {\n                        console.log(err);\n                        transaction.rollback(err => {\n                        });\n                    }\n                } else {\n                    transaction.commit(err => {\n                        console.log(\"retorno last\");\n                        console.log(result);\n                        if(result.recordset != undefined) {\n                            if(result.recordset.length) {\n                                this.editarRiesgo(result.recordset[0].ID, result.recordset[0].nombre, result.recordset[0].peso, result.recordset[0].tolerancia, result.recordset[0].valorIdeal, result.recordset[0].idRiesgoPadre);\n                            }\n                        }\n                    });\n                }\n            });\n        }); // fin transaction\n    }\n\n    render() {\n        if(this.state.componenteActual.localeCompare(\"selRiesgo\") == 0) {\n            return (\n                <div>\n                    <SeleccionarRiesgo pool={this.props.pool} configuracionHome={this.props.configuracionHome} crearRiesgo={this.crearRiesgo} editarRiesgo={this.editarRiesgo}> </SeleccionarRiesgo>\n                </div>\n            );\n        } else if(this.state.componenteActual.localeCompare(\"crearRiesgo\") == 0) {\n            return (\n                <div>\n                    <CrearRiesgo pool={this.props.pool} showFormula={this.props.showFormula} showCondicionVar={this.props.showCondicionVar} showRiesgos={this.props.showRiesgos} retornoSeleccionRiesgo={this.retornoSeleccionRiesgoSameComponent} retornoSeleccionRiesgoUmbral={this.retornoSeleccionRiesgoDiffComponent} configuracionHome={this.props.configuracionHome} updateNavBar={this.props.updateNavBar} showUmbralHome={this.props.showUmbralHome} riesgos={[]} riesgoPadre={-1} terminoCrearRiesgo={this.terminoCrearRiesgoPasarAEdit}> </CrearRiesgo>\n                </div>\n            );\n        } else if(this.state.componenteActual.localeCompare(\"editarRiesgo\") == 0) {\n            return (\n                <div>\n                    <EditarRiesgo pool={this.props.pool} showFormula={this.props.showFormula} showCondicionVar={this.props.showCondicionVar} showRiesgos={this.props.showRiesgos} retornoSeleccionRiesgo={this.retornoSeleccionRiesgoSameComponent} retornoSeleccionRiesgoUmbral={this.retornoSeleccionRiesgoDiffComponent} configuracionHome={this.props.configuracionHome} updateNavBar={this.props.updateNavBar} showUmbralHome={this.props.showUmbralHome} riesgos={[]} nombreRiesgo={this.state.nombreRiesgo} pesoRiesgo={this.state.pesoRiesgo} toleranciaRiesgo={this.state.toleranciaRiesgo} valorIdealRiesgo={this.state.valorIdealRiesgo} padreRiesgo={this.state.padreRiesgo} updateFormula={this.props.updateFormula}> </EditarRiesgo>\n                </div>\n            );\n        }\n    }\n}\n"],"file":"RiesgoHome.js"}