{"version":3,"sources":["components/Riesgos/RiesgoHome.js"],"names":["isMounted","riesgos","RiesgoHome","props","state","idRiesgoSeleccionado","componenteActual","crearRiesgo","bind","retornoSeleccionRiesgoSameComponent","retornoSeleccionRiesgoDiffComponent","editarRiesgo","retornoEditarRiesgo","terminoCrearRiesgoPasarAEdit","transaction","sql","Transaction","pool","begin","err","rolledBack","on","aborted","request","Request","query","result","console","log","rollback","commit","recordset","setState","showRiesgos","self","setTimeout","id","nombreRiesgo","pesoRiesgo","toleranciaRiesgo","valorIdealRiesgo","padreRiesgo","undefined","length","ID","nombre","peso","tolerancia","valorIdeal","idRiesgoPadre","localeCompare","configuracionHome","showFormula","showCondicionVar","updateNavBar","showUmbralHome","updateFormula","React","Component"],"mappings":"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","sourcesContent":["import React from 'react';\nimport sql from 'mssql';\n\nimport SeleccionarRiesgo from './SeleccionarRiesgo.js';\nimport CrearRiesgo from './CrearRiesgo.js';\nimport EditarRiesgo from './EditarRiesgo.js';\n\nvar isMounted = false, riesgos = [];\n\nexport default class RiesgoHome extends React.Component {\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            idRiesgoSeleccionado: -1,\n            componenteActual: \"selRiesgo\"\n        }\n        this.crearRiesgo = this.crearRiesgo.bind(this);\n        this.retornoSeleccionRiesgoSameComponent = this.retornoSeleccionRiesgoSameComponent.bind(this);\n        this.retornoSeleccionRiesgoDiffComponent = this.retornoSeleccionRiesgoDiffComponent.bind(this);\n        this.editarRiesgo = this.editarRiesgo.bind(this);\n        this.retornoEditarRiesgo = this.retornoEditarRiesgo.bind(this);\n        this.terminoCrearRiesgoPasarAEdit = this.terminoCrearRiesgoPasarAEdit.bind(this);\n    }\n\n    componentDidMount() {\n        isMounted = true;\n        const transaction = new sql.Transaction( this.props.pool );\n        transaction.begin(err => {\n            var rolledBack = false;\n            transaction.on('rollback', aborted => {\n                rolledBack = true;\n            });\n            const request = new sql.Request(transaction);\n            request.query(\"select * from Riesgos\", (err, result) => {\n                if (err) {\n                    if (!rolledBack) {\n                        console.log(err);\n                        transaction.rollback(err => {\n                        });\n                    }\n                } else {\n                    transaction.commit(err => {\n                        riesgos = result.recordset;\n                    });\n                }\n            });\n        }); // fin transaction\n    }\n    componentWillUnmount() {\n        isMounted = false;\n    }\n\n    crearRiesgo () {\n        this.setState({\n            componenteActual: \"crearRiesgo\"\n        });\n    }\n\n    retornoSeleccionRiesgoSameComponent () {\n        this.setState({\n            idRiesgoSeleccionado: -1,\n            componenteActual: \"selRiesgo\"\n        });\n    }\n\n    retornoSeleccionRiesgoDiffComponent () {\n        this.props.showRiesgos();\n        var self = this;\n        setTimeout(function(){\n            self.setState({\n                idRiesgoSeleccionado: -1,\n                componenteActual: \"selRiesgo\"\n            });\n        }, 500);\n    }\n\n    editarRiesgo (id, nombreRiesgo, pesoRiesgo, toleranciaRiesgo, valorIdealRiesgo, padreRiesgo) {\n        this.setState({\n            idRiesgoSeleccionado: id,\n            componenteActual: \"editarRiesgo\",\n            nombreRiesgo: nombreRiesgo,\n            pesoRiesgo: pesoRiesgo,\n            toleranciaRiesgo: toleranciaRiesgo,\n            valorIdealRiesgo: valorIdealRiesgo,\n            padreRiesgo: padreRiesgo\n        });\n    }\n\n    retornoEditarRiesgo () {\n        this.props.showRiesgos();\n        var self = this;\n        if(isMounted) {\n            console.log(\"SI\")\n        } else {\n            console.log(\"NO\")\n        }\n        setTimeout(function(){\n            if(isMounted) {\n                console.log(\"SI\")\n            } else {\n                console.log(\"NO\")\n            }\n            console.log(self)\n            self.setState({\n                componenteActual: \"editarRiesgo\"\n            });\n        }, 3500);\n    }\n\n    terminoCrearRiesgoPasarAEdit (nombreRiesgo) {\n        const transaction = new sql.Transaction( this.props.pool );\n        transaction.begin(err => {\n            var rolledBack = false;\n            transaction.on('rollback', aborted => {\n                rolledBack = true;\n            });\n            const request = new sql.Request(transaction);\n            request.query(\"select * from Riesgos where nombre = '\"+nombreRiesgo+\"'\", (err, result) => {\n                if (err) {\n                    if (!rolledBack) {\n                        console.log(err);\n                        transaction.rollback(err => {\n                        });\n                    }\n                } else {\n                    transaction.commit(err => {\n                        if(result.recordset != undefined) {\n                            if(result.recordset.length) {\n                                this.editarRiesgo(result.recordset[0].ID, result.recordset[0].nombre, result.recordset[0].peso, result.recordset[0].tolerancia, result.recordset[0].valorIdeal, result.recordset[0].idRiesgoPadre);\n                            }\n                        }\n                    });\n                }\n            });\n        }); // fin transaction\n    }\n\n    render() {\n        if(this.state.componenteActual.localeCompare(\"selRiesgo\") == 0) {\n            return (\n                <div>\n                    <SeleccionarRiesgo pool={this.props.pool} configuracionHome={this.props.configuracionHome} crearRiesgo={this.crearRiesgo} editarRiesgo={this.editarRiesgo}> </SeleccionarRiesgo>\n                </div>\n            );\n        } else if(this.state.componenteActual.localeCompare(\"crearRiesgo\") == 0) {\n            return (\n                <div>\n                    <CrearRiesgo pool={this.props.pool} showFormula={this.props.showFormula} showCondicionVar={this.props.showCondicionVar} showRiesgos={this.props.showRiesgos} retornoSeleccionRiesgo={this.retornoSeleccionRiesgoSameComponent} retornoSeleccionRiesgoUmbral={this.retornoSeleccionRiesgoDiffComponent} configuracionHome={this.props.configuracionHome} updateNavBar={this.props.updateNavBar} showUmbralHome={this.props.showUmbralHome} riesgos={riesgos} terminoCrearRiesgo={this.terminoCrearRiesgoPasarAEdit}> </CrearRiesgo>\n                </div>\n            );\n        } else if(this.state.componenteActual.localeCompare(\"editarRiesgo\") == 0) {\n            return (\n                <div>\n                    <EditarRiesgo pool={this.props.pool} showFormula={this.props.showFormula} showCondicionVar={this.props.showCondicionVar} showRiesgos={this.props.showRiesgos} retornoSeleccionRiesgo={this.retornoSeleccionRiesgoSameComponent} retornoSeleccionRiesgoUmbral={this.retornoSeleccionRiesgoDiffComponent} configuracionHome={this.props.configuracionHome} updateNavBar={this.props.updateNavBar} showUmbralHome={this.props.showUmbralHome} riesgos={riesgos} nombreRiesgo={this.state.nombreRiesgo} pesoRiesgo={this.state.pesoRiesgo} toleranciaRiesgo={this.state.toleranciaRiesgo} valorIdealRiesgo={this.state.valorIdealRiesgo} padreRiesgo={this.state.padreRiesgo} updateFormula={this.props.updateFormula} idRiesgoSeleccionado={this.state.idRiesgoSeleccionado}> </EditarRiesgo>\n                </div>\n            );\n        }\n    }\n}\n"],"file":"RiesgoHome.js"}